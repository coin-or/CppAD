<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>Multiple Directions Forward Mode</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="Multiple Directions Forward Mode">
<meta name="keywords" id="keywords" content=" multiple directions forward mode syntax purpose reverse notation n m f q r xq zero order non-zero lower orders x(t) y(t) yq vector example ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_forward_dir_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://coin-or.github.io/CppAD" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td><a href="forward_order.cpp.htm" target="_top">Prev</a>
</td><td><a href="forward_dir.cpp.htm" target="_top">Next</a>
</td><td>
<select onchange='choose_across0(this)'>
<option>Index-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Up-&gt;</option>
<option>CppAD</option>
<option>ADFun</option>
<option>Forward</option>
<option>forward_dir</option>
</select>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_cppad_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_adfun_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_forward_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_forward_dir_htm.js'></script>
</td>
<td>
<select onchange='choose_current0(this)'>
<option>Headings-&gt;</option>
<option>Syntax</option>
<option>Purpose</option>
<option>Reverse Mode</option>
<option>Notation</option>
<option>---..n</option>
<option>---..m</option>
<option>f</option>
<option>q</option>
<option>r</option>
<option>xq</option>
<option>Zero Order</option>
<option>Non-Zero Lower Orders</option>
<option>X(t)</option>
<option>Y(t)</option>
<option>yq</option>
<option>Vector</option>
<option>Example</option>
</select>
</td>
</tr></table><br>
@(@\newcommand{\W}[1]{ \; #1 \; }
\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\D}[2]{ \frac{\partial #1}{\partial #2} }
\newcommand{\DD}[3]{ \frac{\partial^2 #1}{\partial #2 \partial #3} }
\newcommand{\Dpow}[2]{ \frac{\partial^{#1}}{\partial  {#2}^{#1}} }
\newcommand{\dpow}[2]{ \frac{ {\rm d}^{#1}}{{\rm d}\, {#2}^{#1}} }@)@<b>This is cppad-20221105 documentation</b>. Here is a link to its
<a href="https://cppad.readthedocs.io" target="_top"><span style='white-space: nowrap'>current&nbsp;documentation</span></a>
.

<center><b><big><big>Multiple Directions Forward Mode</big></big></b></center>
<br>
<b><big><a name="Syntax" id="Syntax">Syntax</a></big></b>

<br>

<code><i><font color="black"><span style='white-space: nowrap'>yq</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;=&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>f</span></font></i><font color="blue"><span style='white-space: nowrap'>.Forward(</span></font><i><font color="black"><span style='white-space: nowrap'>q</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>xq</span></font></i><font color="blue"><span style='white-space: nowrap'>)<br>
</span></font></code>
<br>
<b><big><a name="Purpose" id="Purpose">Purpose</a></big></b>
<br>
We use <small>@(@
F : \B{R}^n \rightarrow \B{R}^m
@)@</small> to denote the
<a href="glossary.htm#AD Function" target="_top"><span style='white-space: nowrap'>AD&nbsp;function</span></a>
 corresponding to 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
.
Given a function <small>@(@
X : \B{R} \rightarrow \B{R}^n
@)@</small>,
defined by its
<a href="glossary.htm#Taylor Coefficient" target="_top"><span style='white-space: nowrap'>Taylor&nbsp;coefficients</span></a>
,
forward mode computes the Taylor coefficients for the function
<small>@[@

    Y (t) = F [ X(t) ]

@]@</small>
This version of forward mode computes multiple directions as the same
time (reducing the number of passes through the tape). This requires more
memory, but might be faster in some cases.

<br>
<br>
<b><big><a name="Reverse Mode" id="Reverse Mode">Reverse Mode</a></big></b>
<br>
Reverse mode for multiple directions has not yet been implemented.
If you have speed tests that indicate that multiple direction forward
mode is faster, and you want to try multiple direction reverse mode,
contact the CppAD project manager.

<br>
<br>
<b><big><a name="Notation" id="Notation">Notation</a></big></b>


<br>
<br>
<big><a name="Notation.n" id="Notation.n">n</a></big>
<br>
We use 
<code><i><font color="black"><span style='white-space: nowrap'>n</span></font></i></code>
 to denote the dimension of the
<a href="fun_property.htm#Domain" target="_top"><span style='white-space: nowrap'>domain</span></a>
 space for 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
.

<br>
<br>
<big><a name="Notation.m" id="Notation.m">m</a></big>
<br>
We use 
<code><i><font color="black"><span style='white-space: nowrap'>m</span></font></i></code>
 to denote the dimension of the
<a href="fun_property.htm#Range" target="_top"><span style='white-space: nowrap'>range</span></a>
 space for 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
.

<br>
<br>
<b><big><a name="f" id="f">f</a></big></b>
<br>
The <a href="adfun.htm" target="_top"><span style='white-space: nowrap'>ADFun</span></a>
 object 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
 has prototype

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;ADFun&lt;</span></font><i><font color="black"><span style='white-space: nowrap'>Base</span></font></i><font color="blue"><span style='white-space: nowrap'>&gt;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>f</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>
Note that the <a href="adfun.htm" target="_top"><span style='white-space: nowrap'>ADFun</span></a>
 object 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
 is not <code><font color="blue">const</font></code>.
After this call we will have

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>f</span></font></i><font color="blue"><span style='white-space: nowrap'>.size_order()&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;==&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>q</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;+&nbsp;1<br>
&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>f</span></font></i><font color="blue"><span style='white-space: nowrap'>.size_direction()&nbsp;==&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>
<br>
<b><big><a name="q" id="q">q</a></big></b>
<br>
This argument has prototype

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>q</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>
It specifies the order of Taylor Coefficient that we are calculating
and must be greater than zero.
The zero order coefficients can only have one direction computed
and stored in 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>
 so use <a href="forward_zero.htm" target="_top"><span style='white-space: nowrap'>forward_zero</span></a>

to compute the zero order coefficients.

<br>
<br>
<b><big><a name="r" id="r">r</a></big></b>
<br>
This argument has prototype

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;size_t&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>
It specifies the number of directions that are computed together.
If (
<code><i><font color="black"><span style='white-space: nowrap'>r</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;==&nbsp;1</span></font></code>
), you are only using one direction and
<a href="forward_order.htm" target="_top"><span style='white-space: nowrap'>forward_order</span></a>
 is simpler, and should be faster,
than this more general case.

<br>
<br>
<b><big><a name="xq" id="xq">xq</a></big></b>
<br>
The argument 
<code><i><font color="black"><span style='white-space: nowrap'>xq</span></font></i></code>
 has prototype

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>Vector</span></font></i><font color="blue"><span style='white-space: nowrap'>&amp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>xq</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>
and its size must be 
<code><i><font color="black"><span style='white-space: nowrap'>n</span></font></i><font color="blue"><span style='white-space: nowrap'>*</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i></code>

(see <a href="forward_dir.htm#Vector" target="_top"><span style='white-space: nowrap'>Vector</span></a>
 below).
For <small>@(@
\ell = 0 , \ldots , r-1
@)@</small>,
<small>@(@
j = 0 , \ldots , n-1
@)@</small>,
the <code><i>j</i></code>-th component of the <code><i>q</i></code>-th order Taylor coefficient
for <small>@(@
X_\ell (t)
@)@</small> is defined by
<code><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;</span></code> <small>@(@
x_j^{(q),\ell} =
@)@</small> 
<code><i><font color="black"><span style='white-space: nowrap'>xq</span></font></i><font color="blue"><span style='white-space: nowrap'>[&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;*&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>j</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;+&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>ell</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;]</span></font></code>


<br>
<br>
<b><big><a name="Zero Order" id="Zero Order">Zero Order</a></big></b>
<br>
For <small>@(@
j = 0 , \ldots , n-1
@)@</small>,
the <code><i>j</i></code>-th component of the zero order Taylor coefficient
for <small>@(@
X_\ell (t)
@)@</small> is defined by
<code><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;</span></code> <small>@(@
x_j^{(0)} =
@)@</small> 
<code><i><font color="black"><span style='white-space: nowrap'>xk</span></font></i><font color="blue"><span style='white-space: nowrap'>[&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>j</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;]</span></font></code>

where 
<code><i><font color="black"><span style='white-space: nowrap'>xk</span></font></i></code>
 corresponds to the previous call

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>f</span></font></i><font color="blue"><span style='white-space: nowrap'>.Forward(</span></font><i><font color="black"><span style='white-space: nowrap'>k</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>xk</span></font></i><font color="blue"><span style='white-space: nowrap'>)<br>
</span></font></code>
with 
<code><i><font color="black"><span style='white-space: nowrap'>k</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;=&nbsp;0</span></font></code>
.

<br>
<br>
<b><big><a name="Non-Zero Lower Orders" id="Non-Zero Lower Orders">Non-Zero Lower Orders</a></big></b>
<br>
For <small>@(@
\ell = 0 , \ldots , r-1
@)@</small>,
<small>@(@
j = 0 , \ldots , n-1
@)@</small>,
<small>@(@
k = 1, \ldots , q-1
@)@</small>,
the <code><i>j</i></code>-th component of the <code><i>k</i></code>-th order Taylor coefficient
for <small>@(@
X_\ell (t)
@)@</small> is defined by
<code><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;</span></code> <small>@(@
x_j^{(k),\ell} =
@)@</small> 
<code><i><font color="black"><span style='white-space: nowrap'>xk</span></font></i><font color="blue"><span style='white-space: nowrap'>[&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;*&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>j</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;+&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>ell</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;]</span></font></code>

where 
<code><i><font color="black"><span style='white-space: nowrap'>xk</span></font></i></code>
 corresponds to the previous call

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>f</span></font></i><font color="blue"><span style='white-space: nowrap'>.Forward(</span></font><i><font color="black"><span style='white-space: nowrap'>k</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i><font color="blue"><span style='white-space: nowrap'>,&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>xk</span></font></i><font color="blue"><span style='white-space: nowrap'>)<br>
</span></font></code>
Note that 
<code><i><font color="black"><span style='white-space: nowrap'>r</span></font></i></code>
 must have the same value in this previous call.

<br>
<br>
<b><big><a name="X(t)" id="X(t)">X(t)</a></big></b>
<br>
For <small>@(@
\ell = 0 , \ldots , r-1
@)@</small>, the function
<small>@(@
X_\ell : \B{R} \rightarrow \B{R}^n
@)@</small> is defined using
the Taylor coefficients <small>@(@
x^{(k),\ell} \in \B{R}^n
@)@</small>:
<small>@[@

X_\ell (t) = x^{(0)}  + x^{(1),\ell} * t^1 + \cdots +  x^{(q),\ell} t^q

@]@</small>
Note that the <code><i>k</i></code>-th derivative of <small>@(@
X_\ell (t)
@)@</small> is related to
its Taylor coefficients by
<small>@[@

\begin{array}{rcl}
    x^{(0)}       & = & X_\ell (0)
    \\
    x^{(k), \ell} & = & \frac{1}{k !} X_\ell^{(k)} (0)
\end{array}

@]@</small>
for <small>@(@
k = 1 , \ldots , q
@)@</small>.

<br>
<br>
<b><big><a name="Y(t)" id="Y(t)">Y(t)</a></big></b>
<br>
For <small>@(@
\ell = 0 , \ldots , r-1
@)@</small>, the function
<small>@(@
Y_\ell : \B{R} \rightarrow \B{R}^m
@)@</small>  is defined by
<small>@(@
Y_\ell (t) = F[ X_\ell (t) ]
@)@</small>.
We use <small>@(@
y^{(0)}
@)@</small> for the zero order coefficient
and <small>@(@
y^{(k),\ell} \in \B{R}^m
@)@</small> to denote the
hight order coefficients; i.e.,
<small>@[@

Y_\ell (t) = y^{(0)} + y^{(1),\ell} * t^1 + \cdots + y^{(q),\ell} * t^q
+ o( t^q )

@]@</small>
where <small>@(@
o( t^q ) * t^{-q} \rightarrow 0
@)@</small> as <small>@(@
t \rightarrow 0
@)@</small>.
Note that the <code><i>k</i></code>-th derivative of <small>@(@
Y_\ell (t)
@)@</small> is related to
its Taylor coefficients by
<small>@[@

\begin{array}{rcl}
    y^{(0)}       & = & Y_\ell (0)
    \\
    y^{(k), \ell} & = & \frac{1}{k !} Y_\ell^{(k)} (0)
\end{array}

@]@</small>
for <small>@(@
k = 1 , \ldots , q
@)@</small>.

<br>
<br>
<b><big><a name="yq" id="yq">yq</a></big></b>
<br>
The argument 
<code><i><font color="black"><span style='white-space: nowrap'>yq</span></font></i></code>
 has prototype

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>Vector</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>yq</span></font></i><font color="blue"><span style='white-space: nowrap'><br>
</span></font></code>
and its size is 
<code><i><font color="black"><span style='white-space: nowrap'>m</span></font></i><font color="blue"><span style='white-space: nowrap'>*</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i></code>

(see <a href="forward_dir.htm#Vector" target="_top"><span style='white-space: nowrap'>Vector</span></a>
 below).
For <small>@(@
\ell = 0 , \ldots , r-1
@)@</small>,
<small>@(@
i = 0 , \ldots , m-1
@)@</small>,
the <code><i>i</i></code>-th component of the <code><i>q</i></code>-th order Taylor coefficient
for <small>@(@
Y_\ell (t)
@)@</small> is given by
<code><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;</span></code> <small>@(@
y_i^{(q),\ell} =
@)@</small> 
<code><i><font color="black"><span style='white-space: nowrap'>yq</span></font></i><font color="blue"><span style='white-space: nowrap'>[&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>r</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;*&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>i</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;+&nbsp;</span></font><i><font color="black"><span style='white-space: nowrap'>ell</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;]</span></font></code>


<br>
<br>
<b><big><a name="Vector" id="Vector">Vector</a></big></b>
<br>
The type 
<code><i><font color="black"><span style='white-space: nowrap'>Vector</span></font></i></code>
 must be a <a href="simplevector.htm" target="_top"><span style='white-space: nowrap'>SimpleVector</span></a>
 class with
<a href="simplevector.htm#Elements of Specified Type" target="_top"><span style='white-space: nowrap'>elements&nbsp;of&nbsp;type</span></a>


<code><i><font color="black"><span style='white-space: nowrap'>Base</span></font></i></code>
.
The routine <a href="checksimplevector.htm" target="_top"><span style='white-space: nowrap'>CheckSimpleVector</span></a>
 will generate an error message
if this is not the case.


<br>
<br>
<b><big><a name="Example" id="Example">Example</a></big></b>
<br>
The file
<a href="forward_dir.cpp.htm" target="_top"><span style='white-space: nowrap'>forward_dir.cpp</span></a>

contains an example and test using one order (multiple orders).
They return true if they succeed and false otherwise.


<hr>Input File: include/cppad/core/forward/forward_dir.omh

</body>
</html>
