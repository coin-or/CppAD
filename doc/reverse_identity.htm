<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>An Important Reverse Mode Identity</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="An Important Reverse Mode Identity">
<meta name="keywords" id="keywords" content=" important reverse mode identity notation sweep theorem proof ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_reverse_identity_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://coin-or.github.io/CppAD" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td><a href="pow_reverse.htm" target="_top">Prev</a>
</td><td><a href="taylor_ode.htm" target="_top">Next</a>
</td><td>
<select onchange='choose_across0(this)'>
<option>Index-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Up-&gt;</option>
<option>CppAD</option>
<option>Theory</option>
<option>reverse_identity</option>
</select>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_cppad_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_theory_htm.js'></script>
</td>
<td>reverse_identity</td>
<td>
<select onchange='choose_current0(this)'>
<option>Headings-&gt;</option>
<option>Notation</option>
<option>Reverse Sweep</option>
<option>Theorem</option>
<option>Proof</option>
</select>
</td>
</tr></table><br>
@(@\newcommand{\W}[1]{ \; #1 \; }
\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\D}[2]{ \frac{\partial #1}{\partial #2} }
\newcommand{\DD}[3]{ \frac{\partial^2 #1}{\partial #2 \partial #3} }
\newcommand{\Dpow}[2]{ \frac{\partial^{#1}}{\partial  {#2}^{#1}} }
\newcommand{\dpow}[2]{ \frac{ {\rm d}^{#1}}{{\rm d}\, {#2}^{#1}} }@)@<b>This is old CppAD documentation:</b> Here is a link to its
<a href="http://coin-or.github.io/CppAD" target="_top"><span style='white-space: nowrap'>current&nbsp;documentation</span></a>
.

<center><b><big><big>An Important Reverse Mode Identity</big></big></b></center>
The theorem and the proof below is a restatement
of the results on page 236 of
<a href="bib.htm#Evaluating Derivatives" target="_top"><span style='white-space: nowrap'>Evaluating&nbsp;Derivatives</span></a>
.

<br>
<br>
<b><big><a name="Notation" id="Notation">Notation</a></big></b>
<br>
Given a function <small>@(@
f(u, v)
@)@</small> where <small>@(@
u \in \B{R}^n
@)@</small>
we use the notation
<small>@[@

\D{f}{u} (u, v) = \left[ \D{f}{u_1} (u, v) , \cdots , \D{f}{u_n} (u, v) \right]

@]@</small>

<br>
<br>
<b><big><a name="Reverse Sweep" id="Reverse Sweep">Reverse Sweep</a></big></b>
<br>
When using <a href="reverse_any.htm" target="_top"><span style='white-space: nowrap'>reverse&nbsp;mode</span></a>

we are given a function <small>@(@
F : \B{R}^n \rightarrow \B{R}^m
@)@</small>,
a matrix of Taylor coefficients <small>@(@
x \in \B{R}^{n \times p}
@)@</small>,
and a weight vector <small>@(@
w \in \B{R}^m
@)@</small>.
We define the functions <small>@(@
X : \B{R} \times \B{R}^{n \times p} \rightarrow \B{R}^n
@)@</small>,
<small>@(@
W : \B{R} \times \B{R}^{n \times p} \rightarrow \B{R}
@)@</small>, and
<small>@(@
W_j : \B{R}^{n \times p} \rightarrow \B{R}
@)@</small> by
<small>@[@

\begin{array}{rcl}
    X(t , x) & = & x^{(0)} + x^{(1)} t + \cdots + x^{(p-1)} t^{p-1}
    \\
    W(t, x)   & = &  w_0 F_0 [X(t, x)] + \cdots + w_{m-1} F_{m-1} [X(t, x)]
    \\
    W_j (x)   & = & \frac{1}{j!} \Dpow{j}{t} W(0, x)
\end{array}

@]@</small>
where <small>@(@
x^{(j)}
@)@</small> is the <code><i>j</i></code>-th column of <small>@(@
x \in \B{R}^{n \times p}
@)@</small>.
The theorem below implies that
<small>@[@

    \D{ W_j }{ x^{(i)} } (x) = \D{ W_{j-i} }{ x^{(0)} } (x)

@]@</small>
A <a href="reverse_any.htm" target="_top"><span style='white-space: nowrap'>general&nbsp;reverse&nbsp;sweep</span></a>
 calculates the values
<small>@[@

    \D{ W_{p-1} }{ x^{(i)} } (x)  \hspace{1cm} (i = 0 , \ldots , p-1)

@]@</small>
But the return values for a reverse sweep are specified
in terms of the more useful values
<small>@[@

    \D{ W_j }{ x^{(0)} } (x)  \hspace{1cm} (j = 0 , \ldots , p-1)

@]@</small>

<br>
<br>
<b><big><a name="Theorem" id="Theorem">Theorem</a></big></b>
<br>
Suppose that <small>@(@
F : \B{R}^n \rightarrow \B{R}^m
@)@</small> is a <small>@(@
p
@)@</small> times
continuously differentiable function.
Define the functions
<small>@(@
Z : \B{R} \times \B{R}^{n \times p} \rightarrow \B{R}^n
@)@</small>,
<small>@(@
Y : \B{R} \times \B{R}^{n \times p }\rightarrow \B{R}^m
@)@</small>,
and
<small>@(@
y^{(j)} : \B{R}^{n \times p }\rightarrow \B{R}^m
@)@</small> by
<small>@[@

\begin{array}{rcl}
    Z(t, x)  & = & x^{(0)} + x^{(1)} t + \cdots + x^{(p-1)} t^{p-1}
    \\
    Y(t, x)  & = & F [ Z(t, x) ]
    \\
    y^{(j)} (x) & = & \frac{1}{j !} \Dpow{j}{t} Y(0, x)
\end{array}

@]@</small>
where <small>@(@
x^{(j)}
@)@</small> denotes the <code><i>j</i></code>-th column of
<small>@(@
x \in \B{R}^{n \times p}
@)@</small>.
It follows that
for all <small>@(@
i, j
@)@</small> such that <small>@(@
i \leq j < p
@)@</small>,
<small>@[@

\begin{array}{rcl}
\D{ y^{(j)} }{ x^{(i)} } (x) & = & \D{ y^{(j-i)} }{ x^{(0)} } (x)
\end{array}

@]@</small>


<br>
<br>
<b><big><a name="Proof" id="Proof">Proof</a></big></b>
<br>
If follows from the definitions that
<small>@[@

\begin{array}{rclr}
\D{ y^{(j)} }{ x^{(i)} } (x)
& = &
\frac{1}{j ! } \D{ }{ x^{(i)} }
    \left[ \Dpow{j}{t} (F \circ  Z) (t, x)  \right]_{t=0}
\\
& = &
\frac{1}{j ! } \left[ \Dpow{j}{t}
    \D{ }{ x^{(i)} } (F \circ  Z) (t, x)
\right]_{t=0}
\\
& = &
\frac{1}{j ! } \left\{
    \Dpow{j}{t} \left[ t^i ( F^{(1)} \circ Z ) (t, x) \right]
\right\}_{t=0}
\end{array}

@]@</small>
For <small>@(@
k > i
@)@</small>, the <code><i>k</i></code>-th
partial of <small>@(@
t^i
@)@</small> with respect to <small>@(@
t
@)@</small> is zero.
Thus, the partial with respect to <small>@(@
t
@)@</small> is given by
<small>@[@

\begin{array}{rcl}
\Dpow{j}{t} \left[ t^i ( F^{(1)} \circ Z ) (t, x) \right]
& = &
\sum_{k=0}^i
\left( \begin{array}{c} j \\ k \end{array} \right)
\frac{ i ! }{ (i - k) ! } t^{i-k} \;
\Dpow{j-k}{t} ( F^{(1)} \circ Z ) (t, x)
\\
\left\{
    \Dpow{j}{t} \left[ t^i ( F^{(1)} \circ Z ) (t, x) \right]
\right\}_{t=0}
& = &
\left( \begin{array}{c} j \\ i \end{array} \right)
i ! \Dpow{j-i}{t} ( F^{(1)} \circ Z ) (t, x)
\\
& = &
\frac{ j ! }{ (j - i) ! }
\Dpow{j-i}{t} ( F^{(1)} \circ Z ) (t, x)
\\
\D{ y^{(j)} }{ x^{(i)} } (x)
& = &
\frac{ 1 }{ (j - i) ! }
\Dpow{j-i}{t} ( F^{(1)} \circ Z ) (t, x)
\end{array}

@]@</small>
Applying this formula to the case where <small>@(@
j
@)@</small>
is replaced by <small>@(@
j - i
@)@</small> and <small>@(@
i
@)@</small> is replaced by zero,
we obtain
<small>@[@

\D{ y^{(j-i)} }{ x^{(0)} } (x)
=
\frac{ 1 }{ (j - i) ! }
\Dpow{j-i}{t} ( F^{(1)} \circ Z ) (t, x)
=
\D{ y^{(j)} }{ x^{(i)} } (x)

@]@</small>
which completes the proof


<hr>Input File: omh/theory/reverse_identity.omh

</body>
</html>
