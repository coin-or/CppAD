<html>
<script type='text/x-mathjax-config'>
MathJax.Hub.Config({
  tex2jax: {
    inlineMath:  [ ['@(@','@)@'] ] ,
    displayMath: [ ['@[@','@]@'] ]
  }
});
</script>
<script type='text/javascript' src=
'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=default'
>
</script>
<head>
<title>Changes and Additions to CppAD During 2019</title>
<meta http-equiv='Content-Type' content='text/html' charset='utf-8'>
<meta name="description" id="description" content="Changes and Additions to CppAD During 2019">
<meta name="keywords" id="keywords" content=" changes additions to cppad during 2019 06-17 06-10 06-02 05-31 05-28 05-22 05-21 05-07 04-01 03-27 03-19 03-13 02-26 02-23 02-22 02-20 02-06 02-01 01-18 01-17 01-16 01-15 01-14 01-06 01-05 01-11 ">
<style type='text/css'>
body { color : black }
body { background-color : white }
A:link { color : blue }
A:visited { color : purple }
A:active { color : purple }
</style>
<script type='text/javascript' language='JavaScript' src='_whats_new_19_htm.js'>
</script>
</head>
<body>
<table><tr>
<td>
<a href="https://coin-or.github.io/CppAD" target="_top"><img border="0" src="_image.gif"></a>
</td>
<td><a href="whats_new.htm" target="_top">Prev</a>
</td><td><a href="whats_new_18.htm" target="_top">Next</a>
</td><td>
<select onchange='choose_across0(this)'>
<option>Index-&gt;</option>
<option>contents</option>
<option>reference</option>
<option>index</option>
<option>search</option>
<option>external</option>
</select>
</td>
<td>
<select onchange='choose_up0(this)'>
<option>Up-&gt;</option>
<option>CppAD</option>
<option>Appendix</option>
<option>whats_new</option>
<option>whats_new_19</option>
</select>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_cppad_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_appendix_htm.js'></script>
</td>
<td>
<script type='text/javascript' language='JavaScript' src='_childtable_whats_new_htm.js'></script>
</td>
<td>whats_new_19</td>
<td>
<select onchange='choose_current0(this)'>
<option>Headings-&gt;</option>
<option>06-17</option>
<option>06-10</option>
<option>06-02</option>
<option>05-31</option>
<option>05-28</option>
<option>05-22</option>
<option>05-21</option>
<option>05-07</option>
<option>04-01</option>
<option>03-27</option>
<option>03-19</option>
<option>03-13</option>
<option>02-26</option>
<option>02-23</option>
<option>02-22</option>
<option>02-20</option>
<option>02-06</option>
<option>02-01</option>
<option>01-18</option>
<option>01-17</option>
<option>01-16</option>
<option>01-15</option>
<option>01-14</option>
<option>01-06</option>
<option>01-05</option>
<option>01-11</option>
</select>
</td>
</tr></table><br>
@(@\newcommand{\W}[1]{ \; #1 \; }
\newcommand{\R}[1]{ {\rm #1} }
\newcommand{\B}[1]{ {\bf #1} }
\newcommand{\D}[2]{ \frac{\partial #1}{\partial #2} }
\newcommand{\DD}[3]{ \frac{\partial^2 #1}{\partial #2 \partial #3} }
\newcommand{\Dpow}[2]{ \frac{\partial^{#1}}{\partial  {#2}^{#1}} }
\newcommand{\dpow}[2]{ \frac{ {\rm d}^{#1}}{{\rm d}\, {#2}^{#1}} }@)@


<center><b><big><big>Changes and Additions to CppAD During 2019</big></big></b></center>
<br>
<b><big><a name="06-17" id="06-17">06-17</a></big></b>
<br>
A new feature that constructs a <code><font color="blue">ADFun</font></code> object
from a Json representation of a computational graph was added; see
<a href="json2adfun.htm" target="_top"><span style='white-space: nowrap'>json2adfun</span></a>
.
This is a minimal viable product (MVP) and is intended for testing
and only has the addition and multiplication operators.
It is intended for testing and planned to be extended to all operators.

<br>
<br>
<b><big><a name="06-10" id="06-10">06-10</a></big></b>
<br>
Some work was done to improve the speed of sparsity calculations
when using the internal representation for a
<a href="glossary.htm#Sparsity Pattern.Vector of Sets" target="_top"><span style='white-space: nowrap'>vector&nbsp;of&nbsp;sets</span></a>
.
This also reduced the time required by the
<a href="optimize.htm" target="_top"><span style='white-space: nowrap'>optimize</span></a>
 operation for some cases.

<br>
<br>
<b><big><a name="06-02" id="06-02">06-02</a></big></b>
<br>
The version number in the title of the top level for the
<a href="cppad.htm" target="_top"><span style='white-space: nowrap'>CppAD</span></a>
 documentation was not being updated.
This started on <code><font color="blue">20190521</font></code> and has been fixed.

<br>
<br>
<b><big><a name="05-31" id="05-31">05-31</a></big></b>
<br>
Add the <a href="cppad_vector.htm" target="_top"><span style='white-space: nowrap'>swap</span></a>
 operation to the
<code><font color="blue">CppAD::vector</font></code> template class and
<a href="cppad_vector.htm#vectorBool" target="_top"><span style='white-space: nowrap'>vectorBool</span></a>
 class.
In addition, change <a href="cppad_vector.cpp.htm" target="_top"><span style='white-space: nowrap'>cppad_vector.cpp</span></a>
 example
so it focuses on operations that are not in
<a href="simplevector.htm" target="_top"><span style='white-space: nowrap'>SimpleVector</span></a>
.

<br>
<br>
<b><big><a name="05-28" id="05-28">05-28</a></big></b>
<br>
There was a bug in optimizing conditional expressions; i.e.,
optimizing without the option
<a href="optimize.htm#options.no_conditional_skip" target="_top"><span style='white-space: nowrap'>no_conditional_skip</span></a>
.
This was a rare case that involving sets of conditional expressions
and conditionally skipping a specific operator.
The bug was reproduced in a regression test and is fixed.

<br>
<br>
<b><big><a name="05-22" id="05-22">05-22</a></big></b>

<ol type="1"><li>
Some speed improvements were made to the
<a href="for_hes_sparsity.htm" target="_top"><span style='white-space: nowrap'>for_hes_sparsity</span></a>
 algorithm.
To be specific the forward Jacobian and Hessian patterns
are computed during the same pass and using the same structure.
This avoids an extra pass on the operation sequence.
In addition, when <a href="for_hes_sparsity.htm#internal_bool" target="_top"><span style='white-space: nowrap'>internal_bool</span></a>

is false, it enables smart points to the forward Jacobian and Hessian
to share the same underlying sets of integers (when they are equal).
</li><li>

Some minor improvements and updating was done for the
<a href="directory.htm" target="_top"><span style='white-space: nowrap'>directory</span></a>
 and <a href="glossary.htm" target="_top"><span style='white-space: nowrap'>glossary</span></a>
 sections.
</li></ol>


<br>
<br>
<b><big><a name="05-21" id="05-21">05-21</a></big></b>
<br>
Simplify the example computation of Hessian using subgraphs
<a href="subgraph_hes2jac.cpp.htm" target="_top"><span style='white-space: nowrap'>subgraph_hes2jac.cpp</span></a>
.
This simplification was a change from using
<a href="mul_level.htm" target="_top"><span style='white-space: nowrap'>multiple&nbsp;levels&nbsp;of&nbsp;AD</span></a>
 to using <a href="base2ad.htm" target="_top"><span style='white-space: nowrap'>base2ad</span></a>
.

<br>
<br>
<b><big><a name="05-07" id="05-07">05-07</a></big></b>
<br>
There was a bug in the checking for correctness of the
<a href="adolc_sparse_hessian.cpp.htm" target="_top"><span style='white-space: nowrap'>adolc_sparse_hessian.cpp</span></a>
 results.
This was due to the fact that the sparsity patterns for ADOL-C
may have more entires that CppAD knows are zero.

<br>
<br>
<b><big><a name="04-01" id="04-01">04-01</a></big></b>
<br>
Add the optional
<a href="time_test.htm#repeat_out" target="_top"><span style='white-space: nowrap'>repeat_out</span></a>
 argument to the
<code><font color="blue">time_test</font></code> function.

<br>
<br>
<b><big><a name="03-27" id="03-27">03-27</a></big></b>
<br>
Improve the speed of sparse Hessian calculations that
<a href="sparse_hes.htm#coloring.colpack.symmetric" target="_top"><span style='white-space: nowrap'>colpack.symmetric</span></a>

coloring method by directly accessing the coloring determined by Colpack.

<br>
<br>
<b><big><a name="03-19" id="03-19">03-19</a></big></b>
<br>
There was a bug in <a href="reverse_any.htm" target="_top"><span style='white-space: nowrap'>f.Reverse(q,&nbsp;w)</span></a>
 when 
<code><i><font color="black"><span style='white-space: nowrap'>f</span></font></i></code>

contained the  <a href="pow.htm" target="_top"><span style='white-space: nowrap'>pow(x,y)</span></a>
 function and 
<code><i><font color="black"><span style='white-space: nowrap'>x</span></font></i><font color="blue"><span style='white-space: nowrap'>&nbsp;==&nbsp;0</span></font></code>
.
To be specific, it was not reporting zero instead of <code><font color="blue">nan</font></code>
for the derivative. This has been partially, but not completely fixed.
See the <a href="wish_list.htm#Reverse Mode" target="_top"><span style='white-space: nowrap'>reverse&nbsp;mode</span></a>
 in the wish list.

<br>
<br>
<b><big><a name="03-13" id="03-13">03-13</a></big></b>
<br>
Fix a bug in <a href="subgraph_jac_rev.htm" target="_top"><span style='white-space: nowrap'>f.subgraph_jac_rev(x,&nbsp;subset)</span></a>
.
This bug appeared in a test that only returned the upper triangle
of a symmetric matrix (the lower triangle worked).

<br>
<br>
<b><big><a name="02-26" id="02-26">02-26</a></big></b>
<br>
There was a problem linking the boost multi-threading library
on some systems that caused the corresponding check to be skipped.
This has been fixed. To be specific,
<code><font color='blue'><pre style='display:inline'> 
     make check_example_multi_thread_bthread: available
</pre></font></code>
was not in the <a href="cmake.htm#CMake Command" target="_top"><span style='white-space: nowrap'>cmake&nbsp;command</span></a>
 output.
This has been fixed.


<br>
<br>
<b><big><a name="02-23" id="02-23">02-23</a></big></b>
<br>
The return value 
<code><i><font color="black"><span style='white-space: nowrap'>n_sweep</span></font></i></code>
 was changed to
<a href="sparse_jac.htm#n_color" target="_top"><span style='white-space: nowrap'>n_color</span></a>
 because it is not the number
of sweeps when <a href="sparse_jac.htm#group_max" target="_top"><span style='white-space: nowrap'>group_max</span></a>
 is not equal to one.
This change was also made for the
<a href="speed_main.htm#Speed Results.n_color" target="_top"><span style='white-space: nowrap'>speed&nbsp;tests</span></a>
.

<br>
<br>
<b><big><a name="02-22" id="02-22">02-22</a></big></b>
<br>
Add row major order specifications to the speed test routines
<a href="link_sparse_jacobian.htm#Row Major" target="_top"><span style='white-space: nowrap'>link_sparse_jacobian</span></a>
 and
<a href="link_sparse_hessian.htm#Row Major" target="_top"><span style='white-space: nowrap'>link_sparse_hessian</span></a>
.
This reduced the overhead (increased the speed) for the
<a href="adolc_sparse_jacobian.cpp.htm" target="_top"><span style='white-space: nowrap'>adolc_sparse_jacobian.cpp</span></a>
 and
<a href="adolc_sparse_hessian.cpp.htm" target="_top"><span style='white-space: nowrap'>adolc_sparse_hessian.cpp</span></a>
 test cases.

<br>
<br>
<b><big><a name="02-20" id="02-20">02-20</a></big></b>

<ol type="1"><li>
Fix bug below in the new release
<a href="https://github.com/coin-or/CppAD/archive/20190200.1.tar.gz" target="_top"><span style='white-space: nowrap'>20190200.1</span></a>
.
</li><li>

There was a problem locating the boost multi-threading library.
To be specific, the
<a href="cmake.htm#CMake Command" target="_top"><span style='white-space: nowrap'>cmake&nbsp;command</span></a>
 would report

<code><font color="blue"><span style='white-space: nowrap'><br>
&nbsp;&nbsp;&nbsp;&nbsp;Could&nbsp;not&nbsp;find&nbsp;boost&nbsp;multi-threading&nbsp;library<br>
</span></font></code>
but it would still try to use the library.
This was because a file name with a <code><font color="blue">-</font></code> in it was
also being used for a cmake variable name.
This has been fixed.
</li></ol>


<br>
<br>
<b><big><a name="02-06" id="02-06">02-06</a></big></b>
<br>
Improve the discussion of the purpose of for the different
<a href="subgraph_jac_rev.htm#Purpose" target="_top"><span style='white-space: nowrap'>subgraph</span></a>
 options which computing
sparse Jacobians.

<br>
<br>
<b><big><a name="02-01" id="02-01">02-01</a></big></b>

<ol type="1"><li>
A stable release for 2019 is now available on the
<a href="https://github.com/coin-or/CppAD/releases" target="_top"><span style='white-space: nowrap'>release</span></a>
 page.
</li><li>

The <a href="download.htm" target="_top"><span style='white-space: nowrap'>download</span></a>
 page was edited to include better discussion
of the license and documentation.
</li></ol>



<br>
<br>
<b><big><a name="01-18" id="01-18">01-18</a></big></b>
<br>
The documentation for <a href="atomic_three.htm" target="_top"><span style='white-space: nowrap'>atomic_three</span></a>
,
and its subsections, was improved.

<br>
<br>
<b><big><a name="01-17" id="01-17">01-17</a></big></b>
<br>
The arguments
<a href="atomic_three.htm#parameter_x" target="_top"><span style='white-space: nowrap'>parameter_x</span></a>
 and
<a href="atomic_three.htm#type_x" target="_top"><span style='white-space: nowrap'>type_x</span></a>
 were included
for all the <code><font color="blue">atomic_three</font></code> virtual functions.

<br>
<br>
<b><big><a name="01-16" id="01-16">01-16</a></big></b>
<br>
More improvements, and bug fixes, in the optimization of <a href="atomic.htm" target="_top"><span style='white-space: nowrap'>atomic</span></a>

operations.
This results in a reduction in the number of parameters
<a href="seq_property.htm#size_par" target="_top"><span style='white-space: nowrap'>size_par</span></a>

and the number of variables
<a href="seq_property.htm#size_var" target="_top"><span style='white-space: nowrap'>size_var</span></a>
.

<br>
<br>
<b><big><a name="01-15" id="01-15">01-15</a></big></b>
<br>
Fix a bug in the optimization of <a href="atomic_three.htm" target="_top"><span style='white-space: nowrap'>atomic_three</span></a>

operations with <a href="independent.htm#dynamic" target="_top"><span style='white-space: nowrap'>dynamic</span></a>
 parameters.

<br>
<br>
<b><big><a name="01-14" id="01-14">01-14</a></big></b>

<ol type="1"><li>
The <a href="atomic_three_rev_depend.htm" target="_top"><span style='white-space: nowrap'>rev_depend</span></a>
 call back function
was added to <code><font color="blue">atomic_three</font></code> class.
This enables one to <a href="optimize.htm" target="_top"><span style='white-space: nowrap'>optimize</span></a>
 functions that use
<code><font color="blue">atomic_three</font></code> operations; see
the <a href="atomic_three_rev_depend.cpp.htm" target="_top"><span style='white-space: nowrap'>rev_depend.cpp</span></a>
 example.
</li><li>

The ability to <a href="optimize.htm" target="_top"><span style='white-space: nowrap'>optimize</span></a>
 functions was extended to
<a href="chkpoint_two.htm" target="_top"><span style='white-space: nowrap'>chkpoint_two</span></a>
 operations; e.g., a call to optimize was added
at the end of the
<a href="chkpoint_two_get_started.cpp.htm" target="_top"><span style='white-space: nowrap'>get_started.cpp</span></a>
 example.
</li><li>

The <a href="chkpoint_one.htm" target="_top"><span style='white-space: nowrap'>chkpoint_one</span></a>
 class was deprecated,
use <a href="chkpoint_two.htm" target="_top"><span style='white-space: nowrap'>chkpoint_two</span></a>
 instead.
</li></ol>


<br>
<br>
<b><big><a name="01-06" id="01-06">01-06</a></big></b>
<br>
One of the two atomic matrix multiply examples was converted
from using <a href="atomic_two.htm" target="_top"><span style='white-space: nowrap'>atomic_two</span></a>
 to <a href="atomic_three_mat_mul.cpp.htm" target="_top"><span style='white-space: nowrap'>atomic_three_mat_mul.cpp</span></a>
.
This conversion made it clear that the 
<code><i><font color="black"><span style='white-space: nowrap'>type_x</span></font></i></code>
 argument
needed to be included in the
<a href="atomic_three_jac_sparsity.htm#type_x" target="_top"><span style='white-space: nowrap'>jac_sparsity</span></a>
 and
<a href="atomic_three_hes_sparsity.htm#type_x" target="_top"><span style='white-space: nowrap'>hes_sparsity</span></a>
 functions.

<br>
<br>
<b><big><a name="01-05" id="01-05">01-05</a></big></b>
<br>
Merge in the <code><font color="blue">atomic branch</font></code>.
This completed <a href="wish_list.htm" target="_top"><span style='white-space: nowrap'>wish_list</span></a>
 item for the new atomic function API;
see <a href="atomic_three.htm" target="_top"><span style='white-space: nowrap'>atomic_three</span></a>
.
This is an improvement over the <a href="atomic_two.htm" target="_top"><span style='white-space: nowrap'>atomic_two</span></a>
 interface,
which used the <code><font color="blue">atomic_base</font></code> class and has been deprecated.
In addition the following changes were included:
<ol type="1"><li>
Move the checkpoint examples below the
<a href="chkpoint_one.htm" target="_top"><span style='white-space: nowrap'>checkpoint</span></a>
 documentation.
</li><li>

A phantom parameter, at index zero, was added; see
<a href="seq_property.htm#size_par" target="_top"><span style='white-space: nowrap'>size_par</span></a>
.
</li><li>

There appears to have been a bug in <code><font color="blue">put_con_par</font></code> (not tested for)
whereby a constant parameter might match a dynamic parameter
(and get changed). This has been fixed.
</li><li>

There was a mistake in the <code><font color="blue">check_variable_dag</font></code> routine whereby
the operator <code><font color="blue">LeppOp</font></code> checked a parameter index as if it were
a variable index. This has been fixed.
</li></ol>


<br>
<br>
<b><big><a name="01-11" id="01-11">01-11</a></big></b>
<br>
Merge in the <code><font color="blue">chkpoint</font></code> branch.
<ol type="1"><li>
This created the <a href="chkpoint_two.htm" target="_top"><span style='white-space: nowrap'>chkpoint_two</span></a>
 class as a replacement
for the <a href="chkpoint_one.htm" target="_top"><span style='white-space: nowrap'>chkpoint_one</span></a>
 class.
This new checkpoint class takes advantage
of <a href="glossary.htm#Parameter.Dynamic" target="_top"><span style='white-space: nowrap'>dynamic&nbsp;parameters</span></a>

and can be used with <a href="base2ad.htm" target="_top"><span style='white-space: nowrap'>base2ad</span></a>
.
</li><li>

While creating the <code><font color="blue">chkpoint_two</font></code> class,
a problem was discovered in the <a href="atomic_three.htm" target="_top"><span style='white-space: nowrap'>atomic_three</span></a>
 class.
To be specific, it does not yet work with <a href="optimize.htm" target="_top"><span style='white-space: nowrap'>optimize</span></a>
.
A reverse dependency analysis is the proper way to fix this.
The <code><font color="blue">atomic_three</font></code> <code><font color="blue">type</font></code> member function does a forward
<a href="atomic_three_for_type.htm#Dependency Analysis" target="_top"><span style='white-space: nowrap'>dependency&nbsp;analysis</span></a>

and so its name was changed from <code><font color="blue">type</font></code> to <code><font color="blue">for_type</font></code>.
</li></ol>



<hr>Input File: omh/appendix/whats_new/19.omh

</body>
</html>
