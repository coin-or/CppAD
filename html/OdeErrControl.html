<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="OdeErrControl, an, error, controller, for, ode, solvers" name="keywords" />
<meta content="syntax" name="keywords" />
<meta content="description" name="keywords" />
<meta content="include" name="keywords" />
<meta content="notation" name="keywords" />
<meta content="xf" name="keywords" />
<meta content="method" name="keywords" />
<meta content="step" name="keywords" />
<meta content="nan" name="keywords" />
<meta content="order" name="keywords" />
<meta content="ti" name="keywords" />
<meta content="tf" name="keywords" />
<meta content="xi" name="keywords" />
<meta content="smin" name="keywords" />
<meta content="smax" name="keywords" />
<meta content="scur" name="keywords" />
<meta content="eabs" name="keywords" />
<meta content="erel" name="keywords" />
<meta content="ef" name="keywords" />
<meta content="maxabs" name="keywords" />
<meta content="nstep" name="keywords" />
<meta content="error, criteria, discussion" name="keywords" />
<meta content="scalar" name="keywords" />
<meta content="vector" name="keywords" />
<meta content="example" name="keywords" />
<meta content="theory" name="keywords" />
<meta content="source, code" name="keywords" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OdeErrControl &mdash; cppad  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ode_err_control.cpp" href="ode_err_control.cpp.html" />
    <link rel="prev" title="near_equal.cpp" href="near_equal.cpp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="xrst_root_doc.html" class="icon icon-home"> cppad
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="xrst_table_of_contents.html">Table of Contents</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="CppAD.html">CppAD</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Install.html">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="Theory.html">Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="AD.html">AD</a></li>
<li class="toctree-l2"><a class="reference internal" href="ADFun.html">ADFun</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocessor.html">preprocessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_thread.html">multi_thread</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="utility.html">utility</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="CheckNumericType.html">CheckNumericType</a></li>
<li class="toctree-l3"><a class="reference internal" href="CheckSimpleVector.html">CheckSimpleVector</a></li>
<li class="toctree-l3"><a class="reference internal" href="create_dll_lib.html">create_dll_lib</a></li>
<li class="toctree-l3"><a class="reference internal" href="ErrorHandler.html">ErrorHandler</a></li>
<li class="toctree-l3"><a class="reference internal" href="index_sort.html">index_sort</a></li>
<li class="toctree-l3"><a class="reference internal" href="link_dll_lib.html">link_dll_lib</a></li>
<li class="toctree-l3"><a class="reference internal" href="nan.html">nan</a></li>
<li class="toctree-l3"><a class="reference internal" href="NearEqual.html">NearEqual</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">OdeErrControl</a><ul>
<li class="toctree-l4"><a class="reference internal" href="ode_err_control.cpp.html">ode_err_control.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="ode_err_maxabs.cpp.html">ode_err_maxabs.cpp</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="OdeGear.html">OdeGear</a></li>
<li class="toctree-l3"><a class="reference internal" href="OdeGearControl.html">OdeGearControl</a></li>
<li class="toctree-l3"><a class="reference internal" href="Poly.html">Poly</a></li>
<li class="toctree-l3"><a class="reference internal" href="pow_int.html">pow_int</a></li>
<li class="toctree-l3"><a class="reference internal" href="RombergMul.html">RombergMul</a></li>
<li class="toctree-l3"><a class="reference internal" href="RombergOne.html">RombergOne</a></li>
<li class="toctree-l3"><a class="reference internal" href="Rosen34.html">Rosen34</a></li>
<li class="toctree-l3"><a class="reference internal" href="Runge45.html">Runge45</a></li>
<li class="toctree-l3"><a class="reference internal" href="set_union.html">set_union</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparse2eigen.html">sparse2eigen</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparse_rc.html">sparse_rc</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparse_rcv.html">sparse_rcv</a></li>
<li class="toctree-l3"><a class="reference internal" href="speed_test.html">speed_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="SpeedTest.html">SpeedTest</a></li>
<li class="toctree-l3"><a class="reference internal" href="test_boolofvoid.html">test_boolofvoid</a></li>
<li class="toctree-l3"><a class="reference internal" href="time_test.html">time_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="to_string.html">to_string</a></li>
<li class="toctree-l3"><a class="reference internal" href="CppAD_vector.html">CppAD_vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="lu_det_and_solve.html">lu_det_and_solve</a></li>
<li class="toctree-l3"><a class="reference internal" href="NumericType.html">NumericType</a></li>
<li class="toctree-l3"><a class="reference internal" href="SimpleVector.html">SimpleVector</a></li>
<li class="toctree-l3"><a class="reference internal" href="thread_alloc.html">thread_alloc</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ipopt_solve.html">ipopt_solve</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example.html">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="speed.html">speed</a></li>
<li class="toctree-l2"><a class="reference internal" href="Appendix.html">Appendix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xrst_index.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="xrst_root_doc.html">cppad</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="xrst_root_doc.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="CppAD.html">CppAD</a> &raquo;</li>
          <li><a href="utility.html">utility</a> &raquo;</li>
      <li>OdeErrControl</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/OdeErrControl.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p class="hidden"><span class="math notranslate nohighlight">\(\newcommand{\W}[1]{ \; #1 \; }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\R}[1]{ {\rm #1} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\B}[1]{ {\bf #1} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\D}[2]{ \frac{\partial #1}{\partial #2} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\DD}[3]{ \frac{\partial^2 #1}{\partial #2 \partial #3} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Dpow}[2]{ \frac{\partial^{#1}}{\partial  {#2}^{#1}} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\dpow}[2]{ \frac{ {\rm d}^{#1}}{{\rm d}\, {#2}^{#1}} }\)</span></p>
<section id="odeerrcontrol">
<span id="odeerrcontrol-name"></span><h1>OdeErrControl<a class="headerlink" href="#odeerrcontrol" title="Permalink to this headline"></a></h1>
<section id="an-error-controller-for-ode-solvers">
<span id="odeerrcontrol-title"></span><span id="index-0"></span><h2>An Error Controller for ODE Solvers<a class="headerlink" href="#an-error-controller-for-ode-solvers" title="Permalink to this headline"></a></h2>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#syntax" id="id1">Syntax</a></p></li>
<li><p><a class="reference internal" href="#description" id="id2">Description</a></p></li>
<li><p><a class="reference internal" href="#include" id="id3">Include</a></p></li>
<li><p><a class="reference internal" href="#notation" id="id4">Notation</a></p></li>
<li><p><a class="reference internal" href="#xf" id="id5">xf</a></p></li>
<li><p><a class="reference internal" href="#method" id="id6">Method</a></p>
<ul>
<li><p><a class="reference internal" href="#step" id="id7">step</a></p></li>
<li><p><a class="reference internal" href="#nan" id="id8">Nan</a></p></li>
<li><p><a class="reference internal" href="#order" id="id9">order</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#ti" id="id10">ti</a></p></li>
<li><p><a class="reference internal" href="#tf" id="id11">tf</a></p></li>
<li><p><a class="reference internal" href="#xi" id="id12">xi</a></p></li>
<li><p><a class="reference internal" href="#smin" id="id13">smin</a></p></li>
<li><p><a class="reference internal" href="#smax" id="id14">smax</a></p></li>
<li><p><a class="reference internal" href="#scur" id="id15">scur</a></p></li>
<li><p><a class="reference internal" href="#eabs" id="id16">eabs</a></p></li>
<li><p><a class="reference internal" href="#erel" id="id17">erel</a></p></li>
<li><p><a class="reference internal" href="#ef" id="id18">ef</a></p></li>
<li><p><a class="reference internal" href="#maxabs" id="id19">maxabs</a></p></li>
<li><p><a class="reference internal" href="#nstep" id="id20">nstep</a></p></li>
<li><p><a class="reference internal" href="#error-criteria-discussion" id="id21">Error Criteria Discussion</a></p></li>
<li><p><a class="reference internal" href="#scalar" id="id22">Scalar</a></p></li>
<li><p><a class="reference internal" href="#vector" id="id23">Vector</a></p></li>
<li><p><a class="reference internal" href="#example" id="id24">Example</a></p></li>
<li><p><a class="reference internal" href="#theory" id="id25">Theory</a></p></li>
<li><p><a class="reference internal" href="#source-code" id="id26">Source Code</a></p></li>
</ul>
</div>
<section id="syntax">
<span id="odeerrcontrol-syntax"></span><span id="index-1"></span><h3><a class="toc-backref" href="#id1">Syntax</a><a class="headerlink" href="#syntax" title="Permalink to this headline"></a></h3>
<div class="line-block">
<div class="line"># <code class="docutils literal notranslate"><span class="pre">include</span> <span class="pre">&lt;cppad/utility/ode_err_control.hpp&gt;</span></code></div>
<div class="line"><em>xf</em> = <code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> ( <em>method</em> , <em>ti</em> , <em>tf</em> , <em>xi</em> ,</div>
<div class="line">      <code class="docutils literal notranslate"><span class="pre">smin</span></code> , <code class="docutils literal notranslate"><span class="pre">smax</span></code> , <code class="docutils literal notranslate"><span class="pre">scur</span></code> , <code class="docutils literal notranslate"><span class="pre">eabs</span></code> , <code class="docutils literal notranslate"><span class="pre">erel</span></code> , <code class="docutils literal notranslate"><span class="pre">ef</span></code> , <code class="docutils literal notranslate"><span class="pre">maxabs</span></code> , <code class="docutils literal notranslate"><span class="pre">nstep</span></code>  )</div>
</div>
</section>
<section id="description">
<span id="odeerrcontrol-description"></span><span id="index-2"></span><h3><a class="toc-backref" href="#id2">Description</a><a class="headerlink" href="#description" title="Permalink to this headline"></a></h3>
<p>Let <span class="math notranslate nohighlight">\(\B{R}\)</span> denote the real numbers
and let <span class="math notranslate nohighlight">\(F : \B{R} \times \B{R}^n \rightarrow \B{R}^n\)</span> be a smooth function.
We define <span class="math notranslate nohighlight">\(X : [ti , tf] \rightarrow \B{R}^n\)</span> by
the following initial value problem:</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   X(ti)  &amp; = &amp; xi    \\
   X'(t)  &amp; = &amp; F[t , X(t)]
\end{eqnarray}</div><p>The routine <code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> can be used to adjust the step size
used an arbitrary integration methods in order to be as fast as possible
and still with in a requested error bound.</p>
</section>
<section id="include">
<span id="odeerrcontrol-include"></span><span id="index-3"></span><h3><a class="toc-backref" href="#id3">Include</a><a class="headerlink" href="#include" title="Permalink to this headline"></a></h3>
<p>The file <code class="docutils literal notranslate"><span class="pre">cppad/utility/ode_err_control.hpp</span></code> is included by
<code class="docutils literal notranslate"><span class="pre">cppad/cppad.hpp</span></code>
but it can also be included separately with out the rest of
the <code class="docutils literal notranslate"><span class="pre">CppAD</span></code> routines.</p>
</section>
<section id="notation">
<span id="odeerrcontrol-notation"></span><span id="index-4"></span><h3><a class="toc-backref" href="#id4">Notation</a><a class="headerlink" href="#notation" title="Permalink to this headline"></a></h3>
<p>The template parameter types <a class="reference internal" href="#odeerrcontrol-scalar"><span class="std std-ref">Scalar</span></a> and
<a class="reference internal" href="#odeerrcontrol-vector"><span class="std std-ref">Vector</span></a> are documented below.</p>
</section>
<section id="xf">
<span id="odeerrcontrol-xf"></span><span id="index-5"></span><h3><a class="toc-backref" href="#id5">xf</a><a class="headerlink" href="#xf" title="Permalink to this headline"></a></h3>
<p>The return value <em>xf</em> has the prototype</p>
<blockquote>
<div><p><em>Vector</em> <em>xf</em></p>
</div></blockquote>
<p>(see description of <a class="reference internal" href="#odeerrcontrol-vector"><span class="std std-ref">Vector</span></a> below).
and the size of <em>xf</em> is equal to <em>n</em> .
If <em>xf</em> contains not a number <a class="reference internal" href="nan.html#nan-name"><span class="std std-ref">nan</span></a> ,
see the discussion of <a class="reference internal" href="#odeerrcontrol-method-nan"><span class="std std-ref">step</span></a> .</p>
</section>
<section id="method">
<span id="odeerrcontrol-method"></span><span id="index-6"></span><h3><a class="toc-backref" href="#id6">Method</a><a class="headerlink" href="#method" title="Permalink to this headline"></a></h3>
<p>The class <em>Method</em>
and the object <em>method</em> satisfy the following syntax</p>
<blockquote>
<div><p><em>Method</em> &amp; <em>method</em></p>
</div></blockquote>
<p>The object <em>method</em> must support <code class="docutils literal notranslate"><span class="pre">step</span></code> and
<code class="docutils literal notranslate"><span class="pre">order</span></code> member functions defined below:</p>
<section id="step">
<span id="odeerrcontrol-method-step"></span><span id="index-7"></span><h4><a class="toc-backref" href="#id7">step</a><a class="headerlink" href="#step" title="Permalink to this headline"></a></h4>
<p>The syntax</p>
<blockquote>
<div><p><em>method</em> . <code class="docutils literal notranslate"><span class="pre">step</span></code> ( <em>ta</em> , <em>tb</em> , <em>xa</em> , <em>xb</em> , <em>eb</em> )</p>
</div></blockquote>
<p>executes one step of the integration method.</p>
<blockquote>
<div><p><em>ta</em></p>
</div></blockquote>
<p>The argument <em>ta</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Scalar</em> &amp; <em>ta</em></p>
</div></blockquote>
<p>It specifies the initial time for this step in the
ODE integration.
(see description of <a class="reference internal" href="#odeerrcontrol-scalar"><span class="std std-ref">Scalar</span></a> below).</p>
<blockquote>
<div><p><em>tb</em></p>
</div></blockquote>
<p>The argument <em>tb</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Scalar</em> &amp; <em>tb</em></p>
</div></blockquote>
<p>It specifies the final time for this step in the
ODE integration.</p>
<blockquote>
<div><p><em>xa</em></p>
</div></blockquote>
<p>The argument <em>xa</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Vector</em> &amp; <em>xa</em></p>
</div></blockquote>
<p>and size <em>n</em> .
It specifies the value of <span class="math notranslate nohighlight">\(X(ta)\)</span>.
(see description of <a class="reference internal" href="#odeerrcontrol-vector"><span class="std std-ref">Vector</span></a> below).</p>
<blockquote>
<div><p><em>xb</em></p>
</div></blockquote>
<p>The argument value <em>xb</em> has prototype</p>
<blockquote>
<div><p><em>Vector</em> &amp; <em>xb</em></p>
</div></blockquote>
<p>and size <em>n</em> .
The input value of its elements does not matter.
On output,
it contains the approximation for <span class="math notranslate nohighlight">\(X(tb)\)</span> that the method obtains.</p>
<blockquote>
<div><p><em>eb</em></p>
</div></blockquote>
<p>The argument value <em>eb</em> has prototype</p>
<blockquote>
<div><p><em>Vector</em> &amp; <em>eb</em></p>
</div></blockquote>
<p>and size <em>n</em> .
The input value of its elements does not matter.
On output,
it contains an estimate for the error in the approximation <em>xb</em> .
It is assumed (locally) that the error bound in this approximation
nearly equal to <span class="math notranslate nohighlight">\(K (tb - ta)^m\)</span>
where <em>K</em> is a fixed constant and <em>m</em>
is the corresponding argument to <code class="docutils literal notranslate"><span class="pre">CodeControl</span></code> .</p>
</section>
<section id="nan">
<span id="odeerrcontrol-method-nan"></span><span id="index-8"></span><h4><a class="toc-backref" href="#id8">Nan</a><a class="headerlink" href="#nan" title="Permalink to this headline"></a></h4>
<p>If any element of the vector <em>eb</em> or <em>xb</em> are
not a number <code class="docutils literal notranslate"><span class="pre">nan</span></code> ,
the current step is considered to large.
If this happens with the current step size equal to <em>smin</em> ,
<code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> returns with <em>xf</em> and <em>ef</em> as vectors
of <code class="docutils literal notranslate"><span class="pre">nan</span></code> .</p>
</section>
<section id="order">
<span id="odeerrcontrol-method-order"></span><span id="index-9"></span><h4><a class="toc-backref" href="#id9">order</a><a class="headerlink" href="#order" title="Permalink to this headline"></a></h4>
<p>If <em>m</em> is <code class="docutils literal notranslate"><span class="pre">size_t</span></code> ,
the object <em>method</em> must also support the following syntax</p>
<blockquote>
<div><p><em>m</em> = <em>method</em> . <code class="docutils literal notranslate"><span class="pre">order</span></code> ()</p>
</div></blockquote>
<p>The return value <em>m</em> is the order of the error estimate;
i.e., there is a constant K such that if <span class="math notranslate nohighlight">\(ti \leq ta \leq tb \leq tf\)</span>,</p>
<div class="math notranslate nohighlight">
\[| eb(tb) | \leq K | tb - ta |^m\]</div>
<p>where <em>ta</em> , <em>tb</em> , and <em>eb</em> are as in
<em>method</em> . <code class="docutils literal notranslate"><span class="pre">step</span></code> ( <em>ta</em> , <em>tb</em> , <em>xa</em> , <em>xb</em> , <em>eb</em> )</p>
</section>
</section>
<section id="ti">
<span id="odeerrcontrol-ti"></span><span id="index-10"></span><h3><a class="toc-backref" href="#id10">ti</a><a class="headerlink" href="#ti" title="Permalink to this headline"></a></h3>
<p>The argument <em>ti</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Scalar</em> &amp; <em>ti</em></p>
</div></blockquote>
<p>It specifies the initial time for the integration of
the differential equation.</p>
</section>
<section id="tf">
<span id="odeerrcontrol-tf"></span><span id="index-11"></span><h3><a class="toc-backref" href="#id11">tf</a><a class="headerlink" href="#tf" title="Permalink to this headline"></a></h3>
<p>The argument <em>tf</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Scalar</em> &amp; <em>tf</em></p>
</div></blockquote>
<p>It specifies the final time for the integration of
the differential equation.</p>
</section>
<section id="xi">
<span id="odeerrcontrol-xi"></span><span id="index-12"></span><h3><a class="toc-backref" href="#id12">xi</a><a class="headerlink" href="#xi" title="Permalink to this headline"></a></h3>
<p>The argument <em>xi</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Vector</em> &amp; <em>xi</em></p>
</div></blockquote>
<p>and size <em>n</em> .
It specifies value of <span class="math notranslate nohighlight">\(X(ti)\)</span>.</p>
</section>
<section id="smin">
<span id="odeerrcontrol-smin"></span><span id="index-13"></span><h3><a class="toc-backref" href="#id13">smin</a><a class="headerlink" href="#smin" title="Permalink to this headline"></a></h3>
<p>The argument <em>smin</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Scalar</em> &amp; <em>smin</em></p>
</div></blockquote>
<p>The step size during a call to <em>method</em> is defined as
the corresponding value of <span class="math notranslate nohighlight">\(tb - ta\)</span>.
If <span class="math notranslate nohighlight">\(tf - ti \leq smin\)</span>,
the integration will be done in one step of size <em>tf - ti</em> .
Otherwise,
the minimum value of <em>tb - ta</em> will be <span class="math notranslate nohighlight">\(smin\)</span>
except for the last two calls to <em>method</em> where it may be
as small as <span class="math notranslate nohighlight">\(smin / 2\)</span>.</p>
</section>
<section id="smax">
<span id="odeerrcontrol-smax"></span><span id="index-14"></span><h3><a class="toc-backref" href="#id14">smax</a><a class="headerlink" href="#smax" title="Permalink to this headline"></a></h3>
<p>The argument <em>smax</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Scalar</em> &amp; <em>smax</em></p>
</div></blockquote>
<p>It specifies the maximum step size to use during the integration;
i.e., the maximum value for <span class="math notranslate nohighlight">\(tb - ta\)</span> in a call to <em>method</em> .
The value of <em>smax</em> must be greater than or equal <em>smin</em> .</p>
</section>
<section id="scur">
<span id="odeerrcontrol-scur"></span><span id="index-15"></span><h3><a class="toc-backref" href="#id15">scur</a><a class="headerlink" href="#scur" title="Permalink to this headline"></a></h3>
<p>The argument <em>scur</em> has prototype</p>
<blockquote>
<div><p><em>Scalar</em> &amp; <em>scur</em></p>
</div></blockquote>
<p>The value of <em>scur</em> is the suggested next step size,
based on error criteria, to try in the next call to <em>method</em> .
On input it corresponds to the first call to <em>method</em> ,
in this call to <code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> (where <span class="math notranslate nohighlight">\(ta = ti\)</span>).
On output it corresponds to the next call to <em>method</em> ,
in a subsequent call to <code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> (where <em>ta</em> = <em>tf</em> ).</p>
</section>
<section id="eabs">
<span id="odeerrcontrol-eabs"></span><span id="index-16"></span><h3><a class="toc-backref" href="#id16">eabs</a><a class="headerlink" href="#eabs" title="Permalink to this headline"></a></h3>
<p>The argument <em>eabs</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Vector</em> &amp; <em>eabs</em></p>
</div></blockquote>
<p>and size <em>n</em> .
Each of the elements of <em>eabs</em> must be
greater than or equal zero.
It specifies a bound for the absolute
error in the return value <em>xf</em> as an approximation for <span class="math notranslate nohighlight">\(X(tf)\)</span>.
(see the
<a class="reference internal" href="#odeerrcontrol-error-criteria-discussion"><span class="std std-ref">Error Criteria Discussion</span></a>
below).</p>
</section>
<section id="erel">
<span id="odeerrcontrol-erel"></span><span id="index-17"></span><h3><a class="toc-backref" href="#id17">erel</a><a class="headerlink" href="#erel" title="Permalink to this headline"></a></h3>
<p>The argument <em>erel</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Scalar</em> &amp; <em>erel</em></p>
</div></blockquote>
<p>and is greater than or equal zero.
It specifies a bound for the relative
error in the return value <em>xf</em> as an approximation for <span class="math notranslate nohighlight">\(X(tf)\)</span>
(see the
<a class="reference internal" href="#odeerrcontrol-error-criteria-discussion"><span class="std std-ref">Error Criteria Discussion</span></a>
below).</p>
</section>
<section id="ef">
<span id="odeerrcontrol-ef"></span><span id="index-18"></span><h3><a class="toc-backref" href="#id18">ef</a><a class="headerlink" href="#ef" title="Permalink to this headline"></a></h3>
<p>The argument value <em>ef</em> has prototype</p>
<blockquote>
<div><p><em>Vector</em> &amp; <em>ef</em></p>
</div></blockquote>
<p>and size <em>n</em> .
The input value of its elements does not matter.
On output,
it contains an estimated bound for the
absolute error in the approximation <em>xf</em> ; i.e.,</p>
<div class="math notranslate nohighlight">
\[ef_i &gt; | X( tf )_i - xf_i |\]</div>
<p>If on output <em>ef</em> contains not a number <code class="docutils literal notranslate"><span class="pre">nan</span></code> ,
see the discussion of <a class="reference internal" href="#odeerrcontrol-method-nan"><span class="std std-ref">step</span></a> .</p>
</section>
<section id="maxabs">
<span id="odeerrcontrol-maxabs"></span><span id="index-19"></span><h3><a class="toc-backref" href="#id19">maxabs</a><a class="headerlink" href="#maxabs" title="Permalink to this headline"></a></h3>
<p>The argument <em>maxabs</em> is optional in the call to <code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> .
If it is present, it has the prototype</p>
<blockquote>
<div><p><em>Vector</em> &amp; <em>maxabs</em></p>
</div></blockquote>
<p>and size <em>n</em> .
The input value of its elements does not matter.
On output,
it contains an estimate for the
maximum absolute value of <span class="math notranslate nohighlight">\(X(t)\)</span>; i.e.,</p>
<div class="math notranslate nohighlight">
\[maxabs[i] \approx \max \left\{
   | X( t )_i | \; : \;  t \in [ti, tf]
\right\}\]</div>
</section>
<section id="nstep">
<span id="odeerrcontrol-nstep"></span><span id="index-20"></span><h3><a class="toc-backref" href="#id20">nstep</a><a class="headerlink" href="#nstep" title="Permalink to this headline"></a></h3>
<p>The argument <em>nstep</em> is optional in the call to <code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> .
If it is present, it has the prototype</p>
<blockquote>
<div><p><em>size_t</em> &amp; <em>nstep</em></p>
</div></blockquote>
<p>Its input value does not matter and its output value
is the number of calls to <em>method</em> . <code class="docutils literal notranslate"><span class="pre">step</span></code>
used by <code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> .</p>
</section>
<section id="error-criteria-discussion">
<span id="odeerrcontrol-error-criteria-discussion"></span><span id="index-21"></span><h3><a class="toc-backref" href="#id21">Error Criteria Discussion</a><a class="headerlink" href="#error-criteria-discussion" title="Permalink to this headline"></a></h3>
<p>The relative error criteria <em>erel</em> and
absolute error criteria <em>eabs</em> are enforced during each step of the
integration of the ordinary differential equations.
In addition, they are inversely scaled by the step size so that
the total error bound is less than the sum of the error bounds.
To be specific, if <span class="math notranslate nohighlight">\(\tilde{X} (t)\)</span> is the approximate solution
at time <span class="math notranslate nohighlight">\(t\)</span>,
<em>ta</em> is the initial step time,
and <em>tb</em> is the final step time,</p>
<div class="math notranslate nohighlight">
\[\left| \tilde{X} (tb)_j  - X (tb)_j \right|
\leq
\frac{tf - ti}{tb - ta}
\left[ eabs[j] + erel \;  | \tilde{X} (tb)_j | \right]\]</div>
<p>If <span class="math notranslate nohighlight">\(X(tb)_j\)</span> is near zero for some <span class="math notranslate nohighlight">\(tb \in [ti , tf]\)</span>,
and one uses an absolute error criteria <span class="math notranslate nohighlight">\(eabs[j]\)</span> of zero,
the error criteria above will force <code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code>
to use step sizes equal to
<a class="reference internal" href="#odeerrcontrol-smin"><span class="std std-ref">smin</span></a>
for steps ending near <span class="math notranslate nohighlight">\(tb\)</span>.
In this case, the error relative to <em>maxabs</em> can be judged after
<code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> returns.
If <em>ef</em> is to large relative to <em>maxabs</em> ,
<code class="docutils literal notranslate"><span class="pre">OdeErrControl</span></code> can be called again
with a smaller value of <em>smin</em> .</p>
</section>
<section id="scalar">
<span id="odeerrcontrol-scalar"></span><span id="index-22"></span><h3><a class="toc-backref" href="#id22">Scalar</a><a class="headerlink" href="#scalar" title="Permalink to this headline"></a></h3>
<p>The type <em>Scalar</em> must satisfy the conditions
for a <a class="reference internal" href="NumericType.html#numerictype-name"><span class="std std-ref">NumericType</span></a> type.
The routine <a class="reference internal" href="CheckNumericType.html#checknumerictype-name"><span class="std std-ref">CheckNumericType</span></a> will generate an error message
if this is not the case.
In addition, the following operations must be defined for
<em>Scalar</em> objects <em>a</em> and <em>b</em> :</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>Operation</strong></p></td>
<td><p><strong>Description</strong></p></td>
</tr>
<tr class="row-even"><td><p><em>a</em> &lt;= <em>b</em></p></td>
<td><p>returns true (false) if <em>a</em> is less than or equal
(greater than) <em>b</em> .</p></td>
</tr>
<tr class="row-odd"><td><p><em>a</em> == <em>b</em></p></td>
<td><p>returns true (false) if <em>a</em> is equal to <em>b</em> .</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">log</span></code> ( <em>a</em> )</p></td>
<td><p>returns a <em>Scalar</em> equal to the logarithm of <em>a</em></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">exp</span></code> ( <em>a</em> )</p></td>
<td><p>returns a <em>Scalar</em> equal to the exponential of <em>a</em></p></td>
</tr>
</tbody>
</table>
</section>
<section id="vector">
<span id="odeerrcontrol-vector"></span><span id="index-23"></span><h3><a class="toc-backref" href="#id23">Vector</a><a class="headerlink" href="#vector" title="Permalink to this headline"></a></h3>
<p>The type <em>Vector</em> must be a <a class="reference internal" href="SimpleVector.html#simplevector-name"><span class="std std-ref">SimpleVector</span></a> class with
<a class="reference internal" href="SimpleVector.html#simplevector-elements-of-specified-type"><span class="std std-ref">elements of type Scalar</span></a> .
The routine <a class="reference internal" href="CheckSimpleVector.html#checksimplevector-name"><span class="std std-ref">CheckSimpleVector</span></a> will generate an error message
if this is not the case.</p>
</section>
<section id="example">
<span id="odeerrcontrol-example"></span><span id="index-24"></span><h3><a class="toc-backref" href="#id24">Example</a><a class="headerlink" href="#example" title="Permalink to this headline"></a></h3>
<p>The files
<a class="reference internal" href="ode_err_control.cpp.html#ode-err-control-cpp-name"><span class="std std-ref">ode_err_control.cpp</span></a>
and
<a class="reference internal" href="ode_err_maxabs.cpp.html#ode-err-maxabs-cpp-name"><span class="std std-ref">ode_err_maxabs.cpp</span></a>
contain examples and tests of using this routine.
They return true if they succeed and false otherwise.</p>
</section>
<section id="theory">
<span id="odeerrcontrol-theory"></span><span id="index-25"></span><h3><a class="toc-backref" href="#id25">Theory</a><a class="headerlink" href="#theory" title="Permalink to this headline"></a></h3>
<p>Let <span class="math notranslate nohighlight">\(e(s)\)</span> be the error as a function of the
step size <span class="math notranslate nohighlight">\(s\)</span> and suppose that there is a constant
<span class="math notranslate nohighlight">\(K\)</span> such that <span class="math notranslate nohighlight">\(e(s) = K s^m\)</span>.
Let <span class="math notranslate nohighlight">\(a\)</span> be our error bound.
Given the value of <span class="math notranslate nohighlight">\(e(s)\)</span>, a step of size <span class="math notranslate nohighlight">\(\lambda s\)</span>
would be ok provided that</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   a  &amp; \geq &amp; e( \lambda s ) (tf - ti) / ( \lambda s ) \\
   a  &amp; \geq &amp; K \lambda^m s^m (tf - ti) / ( \lambda s ) \\
   a  &amp; \geq &amp; \lambda^{m-1} s^{m-1} (tf - ti) e(s) / s^m \\
   a  &amp; \geq &amp; \lambda^{m-1} (tf - ti) e(s) / s           \\
   \lambda^{m-1} &amp; \leq &amp; \frac{a}{e(s)} \frac{s}{tf - ti}
\end{eqnarray}</div><p>Thus if the right hand side of the last inequality is greater
than or equal to one, the step of size <span class="math notranslate nohighlight">\(s\)</span> is ok.</p>
</section>
<section id="source-code">
<span id="odeerrcontrol-source-code"></span><span id="index-26"></span><h3><a class="toc-backref" href="#id26">Source Code</a><a class="headerlink" href="#source-code" title="Permalink to this headline"></a></h3>
<p>The source code for this routine is in the file
<code class="docutils literal notranslate"><span class="pre">cppad/ode_err_control.hpp</span></code> .</p>
<div class="toctree-wrapper compound">
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="near_equal.cpp.html" class="btn btn-neutral float-left" title="near_equal.cpp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="ode_err_control.cpp.html" class="btn btn-neutral float-right" title="ode_err_control.cpp" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>