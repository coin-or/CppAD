<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="atomic_one, defining, atomic, functions:, first, generation" name="keywords" />
<meta content="deprecated, 2013-05-27" name="keywords" />
<meta content="syntax, function" name="keywords" />
<meta content="use, function" name="keywords" />
<meta content="callback, routines" name="keywords" />
<meta content="free, static, memory" name="keywords" />
<meta content="purpose" name="keywords" />
<meta content="partial, implementation" name="keywords" />
<meta content="cppad_user_atomic" name="keywords" />
<meta content="tvector" name="keywords" />
<meta content="base" name="keywords" />
<meta content="ok" name="keywords" />
<meta content="id" name="keywords" />
<meta content="k" name="keywords" />
<meta content="n" name="keywords" />
<meta content="m" name="keywords" />
<meta content="tx" name="keywords" />
<meta content="ty" name="keywords" />
<meta content="forward" name="keywords" />
<meta content="reverse" name="keywords" />
<meta content="afun" name="keywords" />
<meta content="ax" name="keywords" />
<meta content="ay" name="keywords" />
<meta content="parallel, mode" name="keywords" />
<meta content="forward" name="keywords" />
<meta content="usage" name="keywords" />
<meta content="vx" name="keywords" />
<meta content="vy" name="keywords" />
<meta content="reverse" name="keywords" />
<meta content="usage" name="keywords" />
<meta content="py" name="keywords" />
<meta content="px" name="keywords" />
<meta content="for_jac_sparse" name="keywords" />
<meta content="usage" name="keywords" />
<meta content="q" name="keywords" />
<meta content="r" name="keywords" />
<meta content="s" name="keywords" />
<meta content="rev_jac_sparse" name="keywords" />
<meta content="usage" name="keywords" />
<meta content="q" name="keywords" />
<meta content="s" name="keywords" />
<meta content="r" name="keywords" />
<meta content="rev_hes_sparse" name="keywords" />
<meta content="usage" name="keywords" />
<meta content="q" name="keywords" />
<meta content="r" name="keywords" />
<meta content="s" name="keywords" />
<meta content="t" name="keywords" />
<meta content="u" name="keywords" />
<meta content="v" name="keywords" />
<meta content="clear" name="keywords" />
<meta content="restriction" name="keywords" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>atomic_one &mdash; cppad  documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="atomic_two" href="atomic_two.html" />
    <link rel="prev" title="cppad_ipopt_nlp" href="cppad_ipopt_nlp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="xrst_root_doc.html" class="icon icon-home"> cppad
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="xrst_table_of_contents.html">Table of Contents</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="CppAD.html">CppAD</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="Install.html">Install</a></li>
<li class="toctree-l2"><a class="reference internal" href="Theory.html">Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="AD.html">AD</a></li>
<li class="toctree-l2"><a class="reference internal" href="ADFun.html">ADFun</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocessor.html">preprocessor</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_thread.html">multi_thread</a></li>
<li class="toctree-l2"><a class="reference internal" href="utility.html">utility</a></li>
<li class="toctree-l2"><a class="reference internal" href="ipopt_solve.html">ipopt_solve</a></li>
<li class="toctree-l2"><a class="reference internal" href="Example.html">Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="speed.html">speed</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="Appendix.html">Appendix</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="Faq.html">Faq</a></li>
<li class="toctree-l3"><a class="reference internal" href="directory.html">directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="glossary.html">glossary</a></li>
<li class="toctree-l3"><a class="reference internal" href="Bib.html">Bib</a></li>
<li class="toctree-l3"><a class="reference internal" href="wish_list.html">wish_list</a></li>
<li class="toctree-l3"><a class="reference internal" href="whats_new.html">whats_new</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="deprecated.html">deprecated</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="include_deprecated.html">include_deprecated</a></li>
<li class="toctree-l4"><a class="reference internal" href="fun_deprecated.html">fun_deprecated</a></li>
<li class="toctree-l4"><a class="reference internal" href="CompareChange.html">CompareChange</a></li>
<li class="toctree-l4"><a class="reference internal" href="omp_max_thread.html">omp_max_thread</a></li>
<li class="toctree-l4"><a class="reference internal" href="track_new_del.html">track_new_del</a></li>
<li class="toctree-l4"><a class="reference internal" href="omp_alloc.html">omp_alloc</a></li>
<li class="toctree-l4"><a class="reference internal" href="memory_leak.html">memory_leak</a></li>
<li class="toctree-l4"><a class="reference internal" href="epsilon.html">epsilon</a></li>
<li class="toctree-l4"><a class="reference internal" href="cppad_ipopt_nlp.html">cppad_ipopt_nlp</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">atomic_one</a></li>
<li class="toctree-l4"><a class="reference internal" href="atomic_two.html">atomic_two</a></li>
<li class="toctree-l4"><a class="reference internal" href="atomic_two_example.html">atomic_two_example</a></li>
<li class="toctree-l4"><a class="reference internal" href="multi_atomic_two.cpp.html">multi_atomic_two.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="chkpoint_one.html">chkpoint_one</a></li>
<li class="toctree-l4"><a class="reference internal" href="multi_chkpoint_one.cpp.html">multi_chkpoint_one.cpp</a></li>
<li class="toctree-l4"><a class="reference internal" href="zdouble.html">zdouble</a></li>
<li class="toctree-l4"><a class="reference internal" href="autotools.html">autotools</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="compare_c.html">compare_c</a></li>
<li class="toctree-l3"><a class="reference internal" href="numeric_ad.html">numeric_ad</a></li>
<li class="toctree-l3"><a class="reference internal" href="addon.html">addon</a></li>
<li class="toctree-l3"><a class="reference internal" href="License.html">License</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="xrst_index.html">Index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="xrst_root_doc.html">cppad</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="xrst_root_doc.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="CppAD.html">CppAD</a> &raquo;</li>
          <li><a href="Appendix.html">Appendix</a> &raquo;</li>
          <li><a href="deprecated.html">deprecated</a> &raquo;</li>
      <li>atomic_one</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/atomic_one.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p class="hidden"><span class="math notranslate nohighlight">\(\newcommand{\W}[1]{ \; #1 \; }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\R}[1]{ {\rm #1} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\B}[1]{ {\bf #1} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\D}[2]{ \frac{\partial #1}{\partial #2} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\DD}[3]{ \frac{\partial^2 #1}{\partial #2 \partial #3} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\Dpow}[2]{ \frac{\partial^{#1}}{\partial  {#2}^{#1}} }\)</span>
<span class="math notranslate nohighlight">\(\newcommand{\dpow}[2]{ \frac{ {\rm d}^{#1}}{{\rm d}\, {#2}^{#1}} }\)</span></p>
<section id="atomic-one">
<span id="atomic-one-name"></span><h1>atomic_one<a class="headerlink" href="#atomic-one" title="Permalink to this headline"></a></h1>
<section id="defining-atomic-functions-first-generation">
<span id="atomic-one-title"></span><span id="index-0"></span><h2>Defining Atomic Functions: First Generation<a class="headerlink" href="#defining-atomic-functions-first-generation" title="Permalink to this headline"></a></h2>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#deprecated-2013-05-27" id="id13">Deprecated 2013-05-27</a></p></li>
<li><p><a class="reference internal" href="#syntax-function" id="id14">Syntax Function</a></p>
<ul>
<li><p><a class="reference internal" href="#use-function" id="id15">Use Function</a></p></li>
<li><p><a class="reference internal" href="#callback-routines" id="id16">Callback Routines</a></p></li>
<li><p><a class="reference internal" href="#free-static-memory" id="id17">Free Static Memory</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#purpose" id="id18">Purpose</a></p></li>
<li><p><a class="reference internal" href="#partial-implementation" id="id19">Partial Implementation</a></p></li>
<li><p><a class="reference internal" href="#cppad-user-atomic" id="id20">CPPAD_USER_ATOMIC</a></p>
<ul>
<li><p><a class="reference internal" href="#tvector" id="id21">Tvector</a></p></li>
<li><p><a class="reference internal" href="#base" id="id22">Base</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#ok" id="id23">ok</a></p></li>
<li><p><a class="reference internal" href="#atomic-one-id" id="id24">id</a></p></li>
<li><p><a class="reference internal" href="#k" id="id25">k</a></p></li>
<li><p><a class="reference internal" href="#n" id="id26">n</a></p></li>
<li><p><a class="reference internal" href="#m" id="id27">m</a></p></li>
<li><p><a class="reference internal" href="#tx" id="id28">tx</a></p></li>
<li><p><a class="reference internal" href="#ty" id="id29">ty</a></p>
<ul>
<li><p><a class="reference internal" href="#forward" id="id30">forward</a></p></li>
<li><p><a class="reference internal" href="#reverse" id="id31">reverse</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#afun" id="id32">afun</a></p>
<ul>
<li><p><a class="reference internal" href="#ax" id="id33">ax</a></p></li>
<li><p><a class="reference internal" href="#ay" id="id34">ay</a></p></li>
<li><p><a class="reference internal" href="#parallel-mode" id="id35">Parallel Mode</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#atomic-one-forward" id="id36">forward</a></p>
<ul>
<li><p><a class="reference internal" href="#usage" id="id37">Usage</a></p></li>
<li><p><a class="reference internal" href="#vx" id="id38">vx</a></p></li>
<li><p><a class="reference internal" href="#vy" id="id39">vy</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#atomic-one-reverse" id="id40">reverse</a></p>
<ul>
<li><p><a class="reference internal" href="#atomic-one-reverse-usage" id="id41">Usage</a></p></li>
<li><p><a class="reference internal" href="#py" id="id42">py</a></p></li>
<li><p><a class="reference internal" href="#px" id="id43">px</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#for-jac-sparse" id="id44">for_jac_sparse</a></p>
<ul>
<li><p><a class="reference internal" href="#atomic-one-for-jac-sparse-usage" id="id45">Usage</a></p></li>
<li><p><a class="reference internal" href="#q" id="id46">q</a></p></li>
<li><p><a class="reference internal" href="#r" id="id47">r</a></p></li>
<li><p><a class="reference internal" href="#s" id="id48">s</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#rev-jac-sparse" id="id49">rev_jac_sparse</a></p>
<ul>
<li><p><a class="reference internal" href="#atomic-one-rev-jac-sparse-usage" id="id50">Usage</a></p></li>
<li><p><a class="reference internal" href="#atomic-one-rev-jac-sparse-q" id="id51">q</a></p></li>
<li><p><a class="reference internal" href="#atomic-one-rev-jac-sparse-s" id="id52">s</a></p></li>
<li><p><a class="reference internal" href="#atomic-one-rev-jac-sparse-r" id="id53">r</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#rev-hes-sparse" id="id54">rev_hes_sparse</a></p>
<ul>
<li><p><a class="reference internal" href="#atomic-one-rev-hes-sparse-usage" id="id55">Usage</a></p></li>
<li><p><a class="reference internal" href="#atomic-one-rev-hes-sparse-q" id="id56">q</a></p></li>
<li><p><a class="reference internal" href="#atomic-one-rev-hes-sparse-r" id="id57">r</a></p></li>
<li><p><a class="reference internal" href="#atomic-one-rev-hes-sparse-s" id="id58">s</a></p></li>
<li><p><a class="reference internal" href="#t" id="id59">t</a></p></li>
<li><p><a class="reference internal" href="#u" id="id60">u</a></p></li>
<li><p><a class="reference internal" href="#v" id="id61">v</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#clear" id="id62">clear</a></p>
<ul>
<li><p><a class="reference internal" href="#restriction" id="id63">Restriction</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="deprecated-2013-05-27">
<span id="atomic-one-deprecated-2013-05-27"></span><span id="index-1"></span><h3><a class="toc-backref" href="#id13">Deprecated 2013-05-27</a><a class="headerlink" href="#deprecated-2013-05-27" title="Permalink to this headline"></a></h3>
<p>Using <code class="docutils literal notranslate"><span class="pre">CPPAD_USER_ATOMIC</span></code> has been deprecated.
Use <a class="reference internal" href="atomic_three.html#atomic-three-name"><span class="std std-ref">atomic_three</span></a> instead.</p>
</section>
<section id="syntax-function">
<span id="atomic-one-syntax-function"></span><span id="index-2"></span><h3><a class="toc-backref" href="#id14">Syntax Function</a><a class="headerlink" href="#syntax-function" title="Permalink to this headline"></a></h3>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">CPPAD_USER_ATOMIC</span></code> ( <em>afun</em> , <em>Tvector</em> , <em>Base</em> ,</div>
<div class="line">      <em>forward</em> , <em>reverse</em> , <em>for_jac_sparse</em> , <em>rev_jac_sparse</em> , <em>rev_hes_sparse</em></div>
<div class="line">)</div>
</div>
<section id="use-function">
<span id="atomic-one-syntax-function-use-function"></span><span id="index-3"></span><h4><a class="toc-backref" href="#id15">Use Function</a><a class="headerlink" href="#use-function" title="Permalink to this headline"></a></h4>
<blockquote>
<div><p><em>afun</em> ( <em>id</em> , <em>ax</em> , <em>ay</em> )</p>
</div></blockquote>
</section>
<section id="callback-routines">
<span id="atomic-one-syntax-function-callback-routines"></span><span id="index-4"></span><h4><a class="toc-backref" href="#id16">Callback Routines</a><a class="headerlink" href="#callback-routines" title="Permalink to this headline"></a></h4>
<div class="line-block">
<div class="line"><em>ok</em> = <em>forward</em> ( <em>id</em> , <em>k</em> , <em>n</em> , <em>m</em> , <em>vx</em> , <em>vy</em> , <em>tx</em> , <em>ty</em> )</div>
<div class="line"><em>ok</em> = <em>reverse</em> ( <em>id</em> , <em>k</em> , <em>n</em> , <em>m</em> , <em>tx</em> , <em>ty</em> , <em>px</em> , <em>py</em> )</div>
<div class="line"><em>ok</em> = <em>for_jac_sparse</em> ( <em>id</em> , <em>n</em> , <em>m</em> , <em>q</em> , <em>r</em> , <em>s</em> )</div>
<div class="line"><em>ok</em> = <em>rev_jac_sparse</em> ( <em>id</em> , <em>n</em> , <em>m</em> , <em>q</em> , <em>r</em> , <em>s</em> )</div>
<div class="line"><em>ok</em> = <em>rev_hes_sparse</em> ( <em>id</em> , <em>n</em> , <em>m</em> , <em>q</em> , <em>r</em> , <em>s</em> , <em>t</em> , <em>u</em> , <em>v</em> )</div>
</div>
</section>
<section id="free-static-memory">
<span id="atomic-one-syntax-function-free-static-memory"></span><span id="index-5"></span><h4><a class="toc-backref" href="#id17">Free Static Memory</a><a class="headerlink" href="#free-static-memory" title="Permalink to this headline"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">user_atomic&lt;</span></code> <em>Base</em> &gt;:: <code class="docutils literal notranslate"><span class="pre">clear</span></code> ()</p>
</section>
</section>
<section id="purpose">
<span id="atomic-one-purpose"></span><span id="index-6"></span><h3><a class="toc-backref" href="#id18">Purpose</a><a class="headerlink" href="#purpose" title="Permalink to this headline"></a></h3>
<p>In some cases, the user knows how to compute the derivative
of a function</p>
<div class="math notranslate nohighlight">
\[y = f(x) \; {\rm where} \; f : \B{R}^n \rightarrow \B{R}^m\]</div>
<p>more efficiently than by coding it using <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base</em> &gt;
<a class="reference internal" href="glossary.html#glossary-operation-atomic"><span class="std std-ref">atomic_base</span></a> operations
and letting CppAD do the rest.
In this case, <code class="docutils literal notranslate"><span class="pre">CPPAD_USER_ATOMIC</span></code> can be used
add the user code for <span class="math notranslate nohighlight">\(f(x)\)</span>, and its derivatives,
to the set of <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base</em> &gt; atomic operations.</p>
<p>Another possible purpose is to reduce the size of the tape.</p>
</section>
<section id="partial-implementation">
<span id="atomic-one-partial-implementation"></span><span id="index-7"></span><h3><a class="toc-backref" href="#id19">Partial Implementation</a><a class="headerlink" href="#partial-implementation" title="Permalink to this headline"></a></h3>
<p>The routines
<a class="reference internal" href="#atomic-one-forward"><span class="std std-ref">forward</span></a> ,
<a class="reference internal" href="#atomic-one-reverse"><span class="std std-ref">reverse</span></a> ,
<a class="reference internal" href="#atomic-one-for-jac-sparse"><span class="std std-ref">for_jac_sparse</span></a> ,
<a class="reference internal" href="#atomic-one-rev-jac-sparse"><span class="std std-ref">rev_jac_sparse</span></a> , and
<a class="reference internal" href="#atomic-one-rev-hes-sparse"><span class="std std-ref">rev_hes_sparse</span></a> ,
must be defined by the user.
The <em>forward</em> the routine,
for the case <em>k</em>  = 0 , must be implemented.
Functions with the correct prototype,
that just return <code class="docutils literal notranslate"><span class="pre">false</span></code> ,
can be used for the other cases
(unless they are required by your calculations).
For example, you need not implement
<em>forward</em> for the case <em>k</em>  == 2 until you require
forward mode calculation of second derivatives.</p>
</section>
<section id="cppad-user-atomic">
<span id="atomic-one-cppad-user-atomic"></span><span id="index-8"></span><h3><a class="toc-backref" href="#id20">CPPAD_USER_ATOMIC</a><a class="headerlink" href="#cppad-user-atomic" title="Permalink to this headline"></a></h3>
<p>The macro</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">CPPAD_USER_ATOMIC</span></code> ( <em>afun</em> , <em>Tvector</em> , <em>Base</em> ,</div>
<div class="line">      <em>forward</em> , <em>reverse</em> , <em>for_jac_sparse</em> , <em>rev_jac_sparse</em> , <em>rev_hes_sparse</em></div>
<div class="line">)</div>
</div>
<p>defines the <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base</em> &gt; routine <em>afun</em> .
This macro can be placed within a namespace
(not the <code class="docutils literal notranslate"><span class="pre">CppAD</span></code> namespace)
but must be outside of any routine.</p>
<section id="tvector">
<span id="atomic-one-cppad-user-atomic-tvector"></span><span id="index-9"></span><h4><a class="toc-backref" href="#id21">Tvector</a><a class="headerlink" href="#tvector" title="Permalink to this headline"></a></h4>
<p>The macro argument <em>Tvector</em> must be a
<a class="reference internal" href="SimpleVector.html#simplevector-name"><span class="std std-ref">simple vector template class</span></a> .
It determines the type of vectors used as arguments to the routine
<em>afun</em> .</p>
</section>
<section id="base">
<span id="atomic-one-cppad-user-atomic-base"></span><span id="index-10"></span><h4><a class="toc-backref" href="#id22">Base</a><a class="headerlink" href="#base" title="Permalink to this headline"></a></h4>
<p>The macro argument <em>Base</em> specifies the
<a class="reference internal" href="base_require.html#base-require-name"><span class="std std-ref">base type</span></a>
corresponding to <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base&gt;</em> operation sequences.
Calling the routine <em>afun</em> will add the operator defined
by this macro to an <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base&gt;</em> operation sequence.</p>
</section>
</section>
<section id="ok">
<span id="atomic-one-ok"></span><span id="index-11"></span><h3><a class="toc-backref" href="#id23">ok</a><a class="headerlink" href="#ok" title="Permalink to this headline"></a></h3>
<p>For all routines documented below,
the return value <em>ok</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">bool</span></code> <em>ok</em></p>
</div></blockquote>
<p>If it is <code class="docutils literal notranslate"><span class="pre">true</span></code> , the corresponding evaluation succeeded,
otherwise it failed.</p>
</section>
<section id="atomic-one-id">
<span id="index-12"></span><span id="id"></span><h3><a class="toc-backref" href="#id24">id</a><a class="headerlink" href="#atomic-one-id" title="Permalink to this headline"></a></h3>
<p>For all routines documented below,
the argument <em>id</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">size_t</span></code> <em>id</em></p>
</div></blockquote>
<p>Its value in all other calls is the same as in the corresponding
call to <em>afun</em> .
It can be used to store and retrieve extra information about
a specific call to <em>afun</em> .</p>
</section>
<section id="k">
<span id="atomic-one-k"></span><span id="index-13"></span><h3><a class="toc-backref" href="#id25">k</a><a class="headerlink" href="#k" title="Permalink to this headline"></a></h3>
<p>For all routines documented below, the argument <em>k</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">size_t</span></code> <em>k</em></p>
</div></blockquote>
<p>The value <em>k</em> is the order of the Taylor coefficient that
we are evaluating (<a class="reference internal" href="#atomic-one-forward"><span class="std std-ref">forward</span></a> )
or taking the derivative of (<a class="reference internal" href="#atomic-one-reverse"><span class="std std-ref">reverse</span></a> ).</p>
</section>
<section id="n">
<span id="atomic-one-n"></span><span id="index-14"></span><h3><a class="toc-backref" href="#id26">n</a><a class="headerlink" href="#n" title="Permalink to this headline"></a></h3>
<p>For all routines documented below,
the argument <em>n</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">size_t</span></code> <em>n</em></p>
</div></blockquote>
<p>It is the size of the vector <em>ax</em> in the corresponding call to
<em>afun</em> ( <em>id</em> , <em>ax</em> , <em>ay</em> ) ; i.e.,
the dimension of the domain space for <span class="math notranslate nohighlight">\(y = f(x)\)</span>.</p>
</section>
<section id="m">
<span id="atomic-one-m"></span><span id="index-15"></span><h3><a class="toc-backref" href="#id27">m</a><a class="headerlink" href="#m" title="Permalink to this headline"></a></h3>
<p>For all routines documented below, the argument <em>m</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">size_t</span></code> <em>m</em></p>
</div></blockquote>
<p>It is the size of the vector <em>ay</em> in the corresponding call to
<em>afun</em> ( <em>id</em> , <em>ax</em> , <em>ay</em> ) ; i.e.,
the dimension of the range space for <span class="math notranslate nohighlight">\(y = f(x)\)</span>.</p>
</section>
<section id="tx">
<span id="atomic-one-tx"></span><span id="index-16"></span><h3><a class="toc-backref" href="#id28">tx</a><a class="headerlink" href="#tx" title="Permalink to this headline"></a></h3>
<p>For all routines documented below,
the argument <em>tx</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">CppAD::vector&lt;</span></code> <em>Base</em> &gt;&amp; <em>tx</em></p>
</div></blockquote>
<p>and <em>tx</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= ( <em>k</em> + 1) * <em>n</em> .
For <span class="math notranslate nohighlight">\(j = 0 , \ldots , n-1\)</span> and <span class="math notranslate nohighlight">\(\ell = 0 , \ldots , k\)</span>,
we use the Taylor coefficient notation</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   x_j^\ell &amp; = &amp; tx [ j * ( k + 1 ) + \ell ]
   \\
   X_j (t) &amp; = &amp; x_j^0 + x_j^1 t^1 + \cdots + x_j^k t^k
\end{eqnarray}</div><p>If <em>tx</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt; ( <em>k</em> + 1) * <em>n</em> ,
the other components of <em>tx</em> are not specified and should not be used.
Note that superscripts represent an index for <span class="math notranslate nohighlight">\(x_j^\ell\)</span>
and an exponent for <span class="math notranslate nohighlight">\(t^\ell\)</span>.
Also note that the Taylor coefficients for <span class="math notranslate nohighlight">\(X(t)\)</span> correspond
to the derivatives of <span class="math notranslate nohighlight">\(X(t)\)</span> at <span class="math notranslate nohighlight">\(t = 0\)</span> in the following way:</p>
<div class="math notranslate nohighlight">
\[x_j^\ell = \frac{1}{ \ell ! } X_j^{(\ell)} (0)\]</div>
</section>
<section id="ty">
<span id="atomic-one-ty"></span><span id="index-17"></span><h3><a class="toc-backref" href="#id29">ty</a><a class="headerlink" href="#ty" title="Permalink to this headline"></a></h3>
<p>In calls to <a class="reference internal" href="#atomic-one-forward"><span class="std std-ref">forward</span></a> ,
the argument <em>ty</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">CppAD::vector&lt;</span></code> <em>Base</em> &gt;&amp; <em>ty</em></p>
</div></blockquote>
<p>while in calls to <a class="reference internal" href="#atomic-one-reverse"><span class="std std-ref">reverse</span></a> it has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">CppAD::vector&lt;</span></code> <em>Base</em> &gt;&amp; <em>ty</em></p>
</div></blockquote>
<p>For all calls, <em>tx</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= ( <em>k</em> + 1) * <em>m</em> .
For <span class="math notranslate nohighlight">\(i = 0 , \ldots , m-1\)</span> and <span class="math notranslate nohighlight">\(\ell = 0 , \ldots , k\)</span>,
we use the Taylor coefficient notation</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
   y_i^\ell &amp; = &amp; ty [ i * ( k + 1 ) + \ell ]
   \\
   Y_i (t)  &amp; = &amp; y_i^0 + y_i^1 t^1 + \cdots + y_i^k t^k + o ( t^k )
\end{eqnarray}</div><p>where <span class="math notranslate nohighlight">\(o( t^k ) / t^k \rightarrow 0\)</span> as <span class="math notranslate nohighlight">\(t \rightarrow 0\)</span>.
If <em>ty</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt; ( <em>k</em> + 1) * <em>m</em> ,
the other components of <em>ty</em> are not specified and should not be used.
Note that superscripts represent an index for <span class="math notranslate nohighlight">\(y_j^\ell\)</span>
and an exponent for <span class="math notranslate nohighlight">\(t^\ell\)</span>.
Also note that the Taylor coefficients for <span class="math notranslate nohighlight">\(Y(t)\)</span> correspond
to the derivatives of <span class="math notranslate nohighlight">\(Y(t)\)</span> at <span class="math notranslate nohighlight">\(t = 0\)</span> in the following way:</p>
<div class="math notranslate nohighlight">
\[y_j^\ell = \frac{1}{ \ell ! } Y_j^{(\ell)} (0)\]</div>
<section id="forward">
<span id="atomic-one-ty-forward"></span><span id="index-18"></span><h4><a class="toc-backref" href="#id30">forward</a><a class="headerlink" href="#forward" title="Permalink to this headline"></a></h4>
<p>In the case of <em>forward</em> ,
for <span class="math notranslate nohighlight">\(i = 0 , \ldots , m-1\)</span>, <span class="math notranslate nohighlight">\(ty[ i *( k  + 1) + k ]\)</span> is an output
and all the other components of <em>ty</em> are inputs.</p>
</section>
<section id="reverse">
<span id="atomic-one-ty-reverse"></span><span id="index-19"></span><h4><a class="toc-backref" href="#id31">reverse</a><a class="headerlink" href="#reverse" title="Permalink to this headline"></a></h4>
<p>In the case of <em>reverse</em> ,
all the components of <em>ty</em> are inputs.</p>
</section>
</section>
<section id="afun">
<span id="atomic-one-afun"></span><span id="index-20"></span><h3><a class="toc-backref" href="#id32">afun</a><a class="headerlink" href="#afun" title="Permalink to this headline"></a></h3>
<p>The macro argument <em>afun</em> ,
is the name of the AD function corresponding to this atomic
operation (as it is used in the source code).
CppAD uses the other functions,
where the arguments are vectors with elements of type <em>Base</em> ,
to implement the function</p>
<blockquote>
<div><p><em>afun</em> ( <em>id</em> , <em>ax</em> , <em>ay</em> )</p>
</div></blockquote>
<p>where the argument are vectors with elements of type <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base</em> &gt; .</p>
<section id="ax">
<span id="atomic-one-afun-ax"></span><span id="index-21"></span><h4><a class="toc-backref" href="#id33">ax</a><a class="headerlink" href="#ax" title="Permalink to this headline"></a></h4>
<p>The <em>afun</em> argument <em>ax</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span></code> <em>Tvector</em> &lt; <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base</em> &gt; &gt;&amp; <em>ax</em></p>
</div></blockquote>
<p>It is the argument vector <span class="math notranslate nohighlight">\(x \in \B{R}^n\)</span>
at which the <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base</em> &gt; version of
<span class="math notranslate nohighlight">\(y = f(x)\)</span> is to be evaluated.
The dimension of the domain space for <span class="math notranslate nohighlight">\(y = f (x)\)</span>
is specified by <a class="reference internal" href="#atomic-one-n"><span class="std std-ref">n</span></a> = <em>ax</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () ,
which must be greater than zero.</p>
</section>
<section id="ay">
<span id="atomic-one-afun-ay"></span><span id="index-22"></span><h4><a class="toc-backref" href="#id34">ay</a><a class="headerlink" href="#ay" title="Permalink to this headline"></a></h4>
<p>The <em>afun</em> result <em>ay</em> has prototype</p>
<blockquote>
<div><p><em>Tvector</em> &lt; <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base</em> &gt; &gt;&amp; <em>ay</em></p>
</div></blockquote>
<p>The input values of its elements
are not specified (must not matter).
Upon return, it is the <code class="docutils literal notranslate"><span class="pre">AD&lt;</span></code> <em>Base</em> &gt; version of the
result vector <span class="math notranslate nohighlight">\(y = f(x)\)</span>.
The dimension of the range space for <span class="math notranslate nohighlight">\(y = f (x)\)</span>
is specified by <a class="reference internal" href="#atomic-one-m"><span class="std std-ref">m</span></a> = <em>ay</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () ,
which must be greater than zero.</p>
</section>
<section id="parallel-mode">
<span id="atomic-one-afun-parallel-mode"></span><span id="index-23"></span><h4><a class="toc-backref" href="#id35">Parallel Mode</a><a class="headerlink" href="#parallel-mode" title="Permalink to this headline"></a></h4>
<p>The first call to</p>
<blockquote>
<div><p><em>afun</em> ( <em>id</em> , <em>ax</em> , <em>ay</em> )</p>
</div></blockquote>
<p>must not be in <a class="reference internal" href="ta_in_parallel.html#ta-in-parallel-name"><span class="std std-ref">parallel</span></a> mode.
In addition, the
<a class="reference internal" href="#atomic-one-clear"><span class="std std-ref">atomic_one clear</span></a>
routine cannot be called while in parallel mode.</p>
</section>
</section>
<section id="atomic-one-forward">
<span id="index-24"></span><span id="id1"></span><h3><a class="toc-backref" href="#id36">forward</a><a class="headerlink" href="#atomic-one-forward" title="Permalink to this headline"></a></h3>
<p>The macro argument <em>forward</em> is a
user defined function</p>
<blockquote>
<div><p><em>ok</em> = <em>forward</em> ( <em>id</em> , <em>k</em> , <em>n</em> , <em>m</em> , <em>vx</em> , <em>vy</em> , <em>tx</em> , <em>ty</em> )</p>
</div></blockquote>
<p>that computes results during a <a class="reference internal" href="Forward.html#forward-name"><span class="std std-ref">Forward</span></a> mode sweep.
For this call, we are given the Taylor coefficients in <em>tx</em>
form order zero through <em>k</em> ,
and the Taylor coefficients in  <em>ty</em> with order less than <em>k</em> .
The <em>forward</em> routine computes the
<em>k</em> order Taylor coefficients for <span class="math notranslate nohighlight">\(y\)</span> using the definition
<span class="math notranslate nohighlight">\(Y(t) = f[ X(t) ]\)</span>.
For example, for <span class="math notranslate nohighlight">\(i = 0 , \ldots , m-1\)</span>,</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
y_i^0 &amp; = &amp; Y(0)
      = f_i ( x^0 )
\\
y_i^1 &amp; = &amp; Y^{(1)} ( 0 )
      = f_i^{(1)} ( x^0 ) X^{(1)} ( 0 )
      = f_i^{(1)} ( x^0 ) x^1
\\
y_i^2
&amp; = &amp; \frac{1}{2 !} Y^{(2)} (0)
\\
&amp; = &amp; \frac{1}{2} X^{(1)} (0)^\R{T} f_i^{(2)} ( x^0 ) X^{(1)} ( 0 )
  +   \frac{1}{2} f_i^{(1)} ( x^0 ) X^{(2)} ( 0 )
\\
&amp; = &amp; \frac{1}{2} (x^1)^\R{T} f_i^{(2)} ( x^0 ) x^1
  +    f_i^{(1)} ( x^0 ) x^2
\end{eqnarray}</div><p>Then, for <span class="math notranslate nohighlight">\(i = 0 , \ldots , m-1\)</span>, it sets</p>
<div class="math notranslate nohighlight">
\[ty [ i * (k + 1) + k ] = y_i^k\]</div>
<p>The other components of <em>ty</em> must be left unchanged.</p>
<section id="usage">
<span id="atomic-one-forward-usage"></span><span id="index-25"></span><h4><a class="toc-backref" href="#id37">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline"></a></h4>
<p>This routine is used,
with <em>vx</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt; 0 and <em>k</em>  == 0 ,
by calls to <em>afun</em> .
It is used,
with <em>vx</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () = 0 and
<em>k</em> equal to the order of the derivative begin computed,
by calls to <a class="reference internal" href="forward_order.html#forward-order-name"><span class="std std-ref">forward</span></a> .</p>
</section>
<section id="vx">
<span id="atomic-one-forward-vx"></span><span id="index-26"></span><h4><a class="toc-backref" href="#id38">vx</a><a class="headerlink" href="#vx" title="Permalink to this headline"></a></h4>
<p>The <em>forward</em> argument <em>vx</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">CppAD::vector&lt;bool&gt;&amp;</span></code> <em>vx</em></p>
</div></blockquote>
<p>The case <em>vx</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt; 0 occurs
once for each call to <em>afun</em> ,
during the call,
and before any of the other callbacks corresponding to that call.
Hence such a call can be used to cache information attached to
the corresponding <em>id</em>
(such as the elements of <em>vx</em> ).
If <em>vx</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt; 0 then
<em>k</em>  == 0 ,
<em>vx</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>n</em> , and
for <span class="math notranslate nohighlight">\(j = 0 , \ldots , n-1\)</span>,
<em>vx</em> [ <em>j</em> ] is true if and only if
<em>ax</em> [ <em>j</em> ] is a <a class="reference internal" href="glossary.html#glossary-variable"><span class="std std-ref">Variable</span></a> .</p>
<p>If <em>vx</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () == 0 ,
then <em>vy</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () == 0 and neither of these vectors
should be used.</p>
</section>
<section id="vy">
<span id="atomic-one-forward-vy"></span><span id="index-27"></span><h4><a class="toc-backref" href="#id39">vy</a><a class="headerlink" href="#vy" title="Permalink to this headline"></a></h4>
<p>The <em>forward</em> argument <em>vy</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">CppAD::vector&lt;bool&gt;&amp;</span></code> <em>vy</em></p>
</div></blockquote>
<p>If <em>vy</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () == 0 , it should not be used.
Otherwise,
<em>k</em>  == 0 and <em>vy</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>m</em> .
The input values of the elements of <em>vy</em>
are not specified (must not matter).
Upon return, for <span class="math notranslate nohighlight">\(j = 0 , \ldots , m-1\)</span>,
<em>vy</em> [ <em>i</em> ] is true if and only if
<em>ay</em> [ <em>j</em> ] is a variable.
(CppAD uses <em>vy</em> to reduce the necessary computations.)</p>
</section>
</section>
<section id="atomic-one-reverse">
<span id="index-28"></span><span id="id2"></span><h3><a class="toc-backref" href="#id40">reverse</a><a class="headerlink" href="#atomic-one-reverse" title="Permalink to this headline"></a></h3>
<p>The macro argument <em>reverse</em>
is a user defined function</p>
<blockquote>
<div><p><em>ok</em> = <em>reverse</em> ( <em>id</em> , <em>k</em> , <em>n</em> , <em>m</em> , <em>tx</em> , <em>ty</em> , <em>px</em> , <em>py</em> )</p>
</div></blockquote>
<p>that computes results during a <a class="reference internal" href="Reverse.html#reverse-name"><span class="std std-ref">Reverse</span></a> mode sweep.
The input value of the vectors <em>tx</em> and <em>ty</em>
contain Taylor coefficient, up to order <em>k</em> ,
for <span class="math notranslate nohighlight">\(X(t)\)</span> and <span class="math notranslate nohighlight">\(Y(t)\)</span> respectively.
We use the <span class="math notranslate nohighlight">\(\{ x_j^\ell \}\)</span> and <span class="math notranslate nohighlight">\(\{ y_i^\ell \}\)</span>
to denote these Taylor coefficients where the implicit range indices are
<span class="math notranslate nohighlight">\(i = 0 , \ldots , m-1\)</span>,
<span class="math notranslate nohighlight">\(j = 0 , \ldots , n-1\)</span>,
<span class="math notranslate nohighlight">\(\ell = 0 , \ldots , k\)</span>.
Using the calculations done by <a class="reference internal" href="#atomic-one-forward"><span class="std std-ref">forward</span></a> ,
the Taylor coefficients <span class="math notranslate nohighlight">\(\{ y_i^\ell \}\)</span> are a function of the Taylor
coefficients for <span class="math notranslate nohighlight">\(\{ x_j^\ell \}\)</span>; i.e., given <span class="math notranslate nohighlight">\(y = f(x)\)</span>
we define the function
<span class="math notranslate nohighlight">\(F : \B{R}^{n \times (k+1)} \rightarrow \B{R}^{m \times (k+1)}\)</span> by</p>
<div class="math notranslate nohighlight">
\[y_i^\ell =  F_i^\ell ( \{ x_j^\ell \} )\]</div>
<p>We use <span class="math notranslate nohighlight">\(G : \B{R}^{m \times (k+1)} \rightarrow \B{R}\)</span>
to denote an arbitrary scalar valued function of the Taylor coefficients for
<span class="math notranslate nohighlight">\(Y(t)\)</span> and write  <span class="math notranslate nohighlight">\(z = G( \{ y_i^\ell \} )\)</span>.
The <code class="docutils literal notranslate"><span class="pre">reverse</span></code> routine
is given the derivative of <span class="math notranslate nohighlight">\(z\)</span> with respect to
<span class="math notranslate nohighlight">\(\{ y_i^\ell \}\)</span> and computes its derivative with respect
to <span class="math notranslate nohighlight">\(\{ x_j^\ell \}\)</span>.</p>
<section id="atomic-one-reverse-usage">
<span id="index-29"></span><span id="id3"></span><h4><a class="toc-backref" href="#id41">Usage</a><a class="headerlink" href="#atomic-one-reverse-usage" title="Permalink to this headline"></a></h4>
<p>This routine is used,
with <em>k</em>  + 1 equal to the order of the derivative being calculated,
by calls to <a class="reference internal" href="reverse_any.html#reverse-any-name"><span class="std std-ref">reverse</span></a> .</p>
</section>
<section id="py">
<span id="atomic-one-reverse-py"></span><span id="index-30"></span><h4><a class="toc-backref" href="#id42">py</a><a class="headerlink" href="#py" title="Permalink to this headline"></a></h4>
<p>The <em>reverse</em> argument <em>py</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">CppAD::vector&lt;</span></code> <em>Base</em> &gt;&amp; <em>py</em></p>
</div></blockquote>
<p>and <em>py</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= ( <em>k</em> + 1) * <em>m</em> .
For <span class="math notranslate nohighlight">\(i = 0 , \ldots , m-1\)</span> and <span class="math notranslate nohighlight">\(\ell = 0 , \ldots , k\)</span>,</p>
<div class="math notranslate nohighlight">
\[py[ i * (k + 1 ) + \ell ] = \partial G / \partial y_i^\ell\]</div>
<p>If <em>py</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt; ( <em>k</em> + 1) * <em>m</em> ,
the other components of <em>py</em> are not specified and should not be used.</p>
</section>
<section id="px">
<span id="atomic-one-reverse-px"></span><span id="index-31"></span><h4><a class="toc-backref" href="#id43">px</a><a class="headerlink" href="#px" title="Permalink to this headline"></a></h4>
<p>We define the function</p>
<div class="math notranslate nohighlight">
\[H ( \{ x_j^\ell \} ) = G[ F( \{ x_j^\ell \} ) ]\]</div>
<p>The <em>reverse</em> argument <em>px</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">CppAD::vector&lt;</span></code> <em>Base</em> &gt;&amp; <em>px</em></p>
</div></blockquote>
<p>and <em>px</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= ( <em>k</em> + 1) * <em>n</em> .
The input values of the elements of <em>px</em>
are not specified (must not matter).
Upon return,
for <span class="math notranslate nohighlight">\(j = 0 , \ldots , n-1\)</span> and <span class="math notranslate nohighlight">\(p = 0 , \ldots , k\)</span>,</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
px [ j * (k + 1) + p ] &amp; = &amp; \partial H / \partial x_j^p
\\
&amp; = &amp;
( \partial G / \partial \{ y_i^\ell \} )
   ( \partial \{ y_i^\ell \} / \partial x_j^p )
\\
&amp; = &amp;
\sum_{i=0}^{m-1} \sum_{\ell=0}^k
( \partial G / \partial y_i^\ell ) ( \partial y_i^\ell / \partial x_j^p )
\\
&amp; = &amp;
\sum_{i=0}^{m-1} \sum_{\ell=p}^k
py[ i * (k + 1 ) + \ell ] ( \partial F_i^\ell / \partial x_j^p )
\end{eqnarray}</div><p>Note that we have used the fact that for <span class="math notranslate nohighlight">\(\ell &lt; p\)</span>,
<span class="math notranslate nohighlight">\(\partial F_i^\ell / \partial x_j^p = 0\)</span>.
If <em>px</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt; ( <em>k</em> + 1) * <em>n</em> ,
the other components of <em>px</em> are not specified and should not be used.</p>
</section>
</section>
<section id="for-jac-sparse">
<span id="atomic-one-for-jac-sparse"></span><span id="index-32"></span><h3><a class="toc-backref" href="#id44">for_jac_sparse</a><a class="headerlink" href="#for-jac-sparse" title="Permalink to this headline"></a></h3>
<p>The macro argument <em>for_jac_sparse</em>
is a user defined function</p>
<blockquote>
<div><p><em>ok</em> = <em>for_jac_sparse</em> ( <em>id</em> , <em>n</em> , <em>m</em> , <em>q</em> , <em>r</em> , <em>s</em> )</p>
</div></blockquote>
<p>that is used to compute results during a forward Jacobian sparsity sweep.
For a fixed <span class="math notranslate nohighlight">\(n \times q\)</span> matrix <span class="math notranslate nohighlight">\(R\)</span>,
the Jacobian of <span class="math notranslate nohighlight">\(f( x + R * u)\)</span> with respect to <span class="math notranslate nohighlight">\(u \in \B{R}^q\)</span> is</p>
<div class="math notranslate nohighlight">
\[S(x) = f^{(1)} (x) * R\]</div>
<p>Given a <a class="reference internal" href="glossary.html#glossary-sparsity-pattern"><span class="std std-ref">Sparsity Pattern</span></a> for <span class="math notranslate nohighlight">\(R\)</span>,
<em>for_jac_sparse</em> computes a sparsity pattern for <span class="math notranslate nohighlight">\(S(x)\)</span>.</p>
<section id="atomic-one-for-jac-sparse-usage">
<span id="index-33"></span><span id="id4"></span><h4><a class="toc-backref" href="#id45">Usage</a><a class="headerlink" href="#atomic-one-for-jac-sparse-usage" title="Permalink to this headline"></a></h4>
<p>This routine is used by calls to <a class="reference internal" href="ForSparseJac.html#forsparsejac-name"><span class="std std-ref">ForSparseJac</span></a> .</p>
</section>
<section id="q">
<span id="atomic-one-for-jac-sparse-q"></span><span id="index-34"></span><h4><a class="toc-backref" href="#id46">q</a><a class="headerlink" href="#q" title="Permalink to this headline"></a></h4>
<p>The <em>for_jac_sparse</em> argument <em>q</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">size_t</span></code> <em>q</em></p>
</div></blockquote>
<p>It specifies the number of columns in
<span class="math notranslate nohighlight">\(R \in \B{R}^{n \times q}\)</span> and the Jacobian
<span class="math notranslate nohighlight">\(S(x) \in \B{R}^{m \times q}\)</span>.</p>
</section>
<section id="r">
<span id="atomic-one-for-jac-sparse-r"></span><span id="index-35"></span><h4><a class="toc-backref" href="#id47">r</a><a class="headerlink" href="#r" title="Permalink to this headline"></a></h4>
<p>The <em>for_jac_sparse</em> argument <em>r</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">CppAD::vector&lt;</span> <span class="pre">std::set&lt;size_t&gt;</span> <span class="pre">&gt;&amp;</span></code> <em>r</em></p>
</div></blockquote>
<p>and <em>r</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>n</em> .
For <span class="math notranslate nohighlight">\(j = 0 , \ldots , n-1\)</span>,
all the elements of <em>r</em> [ <em>j</em> ] are between
zero and <em>q</em> <code class="docutils literal notranslate"><span class="pre">-1</span></code> inclusive.
This specifies a sparsity pattern for the matrix <span class="math notranslate nohighlight">\(R\)</span>.</p>
</section>
<section id="s">
<span id="atomic-one-for-jac-sparse-s"></span><span id="index-36"></span><h4><a class="toc-backref" href="#id48">s</a><a class="headerlink" href="#s" title="Permalink to this headline"></a></h4>
<p>The <em>for_jac_sparse</em> return value <em>s</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">CppAD::vector&lt;</span> <span class="pre">std::set&lt;size_t&gt;</span> <span class="pre">&gt;&amp;</span></code> <em>s</em></p>
</div></blockquote>
<p>and <em>s</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>m</em> .
The input values of its sets
are not specified (must not matter). Upon return
for <span class="math notranslate nohighlight">\(i = 0 , \ldots , m-1\)</span>,
all the elements of <em>s</em> [ <em>i</em> ] are between
zero and <em>q</em> <code class="docutils literal notranslate"><span class="pre">-1</span></code> inclusive.
This represents a sparsity pattern for the matrix <span class="math notranslate nohighlight">\(S(x)\)</span>.</p>
</section>
</section>
<section id="rev-jac-sparse">
<span id="atomic-one-rev-jac-sparse"></span><span id="index-37"></span><h3><a class="toc-backref" href="#id49">rev_jac_sparse</a><a class="headerlink" href="#rev-jac-sparse" title="Permalink to this headline"></a></h3>
<p>The macro argument <em>rev_jac_sparse</em>
is a user defined function</p>
<blockquote>
<div><p><em>ok</em> = <em>rev_jac_sparse</em> ( <em>id</em> , <em>n</em> , <em>m</em> , <em>q</em> , <em>r</em> , <em>s</em> )</p>
</div></blockquote>
<p>that is used to compute results during a reverse Jacobian sparsity sweep.
For a fixed <span class="math notranslate nohighlight">\(q \times m\)</span> matrix <span class="math notranslate nohighlight">\(S\)</span>,
the Jacobian of <span class="math notranslate nohighlight">\(S * f( x )\)</span> with respect to <span class="math notranslate nohighlight">\(x \in \B{R}^n\)</span> is</p>
<div class="math notranslate nohighlight">
\[R(x) = S * f^{(1)} (x)\]</div>
<p>Given a <a class="reference internal" href="glossary.html#glossary-sparsity-pattern"><span class="std std-ref">Sparsity Pattern</span></a> for <span class="math notranslate nohighlight">\(S\)</span>,
<em>rev_jac_sparse</em> computes a sparsity pattern for <span class="math notranslate nohighlight">\(R(x)\)</span>.</p>
<section id="atomic-one-rev-jac-sparse-usage">
<span id="index-38"></span><span id="id5"></span><h4><a class="toc-backref" href="#id50">Usage</a><a class="headerlink" href="#atomic-one-rev-jac-sparse-usage" title="Permalink to this headline"></a></h4>
<p>This routine is used by calls to <a class="reference internal" href="RevSparseJac.html#revsparsejac-name"><span class="std std-ref">RevSparseJac</span></a>
and to <a class="reference internal" href="optimize.html#optimize-name"><span class="std std-ref">optimize</span></a> .</p>
</section>
<section id="atomic-one-rev-jac-sparse-q">
<span id="index-39"></span><span id="id6"></span><h4><a class="toc-backref" href="#id51">q</a><a class="headerlink" href="#atomic-one-rev-jac-sparse-q" title="Permalink to this headline"></a></h4>
<p>The <em>rev_jac_sparse</em> argument <em>q</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">size_t</span></code> <em>q</em></p>
</div></blockquote>
<p>It specifies the number of rows in
<span class="math notranslate nohighlight">\(S \in \B{R}^{q \times m}\)</span> and the Jacobian
<span class="math notranslate nohighlight">\(R(x) \in \B{R}^{q \times n}\)</span>.</p>
</section>
<section id="atomic-one-rev-jac-sparse-s">
<span id="index-40"></span><span id="id7"></span><h4><a class="toc-backref" href="#id52">s</a><a class="headerlink" href="#atomic-one-rev-jac-sparse-s" title="Permalink to this headline"></a></h4>
<p>The <em>rev_jac_sparse</em> argument <em>s</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">CppAD::vector&lt;</span> <span class="pre">std::set&lt;size_t&gt;</span> <span class="pre">&gt;&amp;</span></code> <em>s</em></p>
</div></blockquote>
<p>and <em>s</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>m</em> .
For <span class="math notranslate nohighlight">\(i = 0 , \ldots , m-1\)</span>,
all the elements of <em>s</em> [ <em>i</em> ]
are between zero and <em>q</em> <code class="docutils literal notranslate"><span class="pre">-1</span></code> inclusive.
This specifies a sparsity pattern for the matrix <span class="math notranslate nohighlight">\(S^\R{T}\)</span>.</p>
</section>
<section id="atomic-one-rev-jac-sparse-r">
<span id="index-41"></span><span id="id8"></span><h4><a class="toc-backref" href="#id53">r</a><a class="headerlink" href="#atomic-one-rev-jac-sparse-r" title="Permalink to this headline"></a></h4>
<p>The <em>rev_jac_sparse</em> return value <em>r</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">CppAD::vector&lt;</span> <span class="pre">std::set&lt;size_t&gt;</span> <span class="pre">&gt;&amp;</span></code> <em>r</em></p>
</div></blockquote>
<p>and <em>r</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>n</em> .
The input values of its sets
are not specified (must not matter).
Upon return for <span class="math notranslate nohighlight">\(j = 0 , \ldots , n-1\)</span>,
all the elements of <em>r</em> [ <em>j</em> ]
are between zero and <em>q</em> <code class="docutils literal notranslate"><span class="pre">-1</span></code> inclusive.
This represents a sparsity pattern for the matrix <span class="math notranslate nohighlight">\(R(x)^\R{T}\)</span>.</p>
</section>
</section>
<section id="rev-hes-sparse">
<span id="atomic-one-rev-hes-sparse"></span><span id="index-42"></span><h3><a class="toc-backref" href="#id54">rev_hes_sparse</a><a class="headerlink" href="#rev-hes-sparse" title="Permalink to this headline"></a></h3>
<p>The macro argument <em>rev_hes_sparse</em>
is a user defined function</p>
<blockquote>
<div><p><em>ok</em> = <em>rev_hes_sparse</em> ( <em>id</em> , <em>n</em> , <em>m</em> , <em>q</em> , <em>r</em> , <em>s</em> , <em>t</em> , <em>u</em> , <em>v</em> )</p>
</div></blockquote>
<p>There is an unspecified scalar valued function
<span class="math notranslate nohighlight">\(g : \B{R}^m \rightarrow \B{R}\)</span>.
Given a sparsity pattern for <span class="math notranslate nohighlight">\(R\)</span>
and information about the function <span class="math notranslate nohighlight">\(z = g(y)\)</span>,
this routine computes the sparsity pattern for</p>
<div class="math notranslate nohighlight">
\[V(x) = (g \circ f)^{(2)}( x ) R\]</div>
<section id="atomic-one-rev-hes-sparse-usage">
<span id="index-43"></span><span id="id9"></span><h4><a class="toc-backref" href="#id55">Usage</a><a class="headerlink" href="#atomic-one-rev-hes-sparse-usage" title="Permalink to this headline"></a></h4>
<p>This routine is used by calls to <a class="reference internal" href="RevSparseHes.html#revsparsehes-name"><span class="std std-ref">RevSparseHes</span></a> .</p>
</section>
<section id="atomic-one-rev-hes-sparse-q">
<span id="index-44"></span><span id="id10"></span><h4><a class="toc-backref" href="#id56">q</a><a class="headerlink" href="#atomic-one-rev-hes-sparse-q" title="Permalink to this headline"></a></h4>
<p>The <em>rev_hes_sparse</em> argument <em>q</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">size_t</span></code> <em>q</em></p>
</div></blockquote>
<p>It specifies the number of columns in the sparsity patterns.</p>
</section>
<section id="atomic-one-rev-hes-sparse-r">
<span id="index-45"></span><span id="id11"></span><h4><a class="toc-backref" href="#id57">r</a><a class="headerlink" href="#atomic-one-rev-hes-sparse-r" title="Permalink to this headline"></a></h4>
<p>The <em>rev_hes_sparse</em> argument <em>r</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">CppAD::vector&lt;</span> <span class="pre">std::set&lt;size_t&gt;</span> <span class="pre">&gt;&amp;</span></code> <em>r</em></p>
</div></blockquote>
<p>and <em>r</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>n</em> .
For <span class="math notranslate nohighlight">\(j = 0 , \ldots , n-1\)</span>,
all the elements of <em>r</em> [ <em>j</em> ] are between
zero and <em>q</em> <code class="docutils literal notranslate"><span class="pre">-1</span></code> inclusive.
This specifies a sparsity pattern for the matrix <span class="math notranslate nohighlight">\(R \in \B{R}^{n \times q}\)</span>.</p>
</section>
<section id="atomic-one-rev-hes-sparse-s">
<span id="index-46"></span><span id="id12"></span><h4><a class="toc-backref" href="#id58">s</a><a class="headerlink" href="#atomic-one-rev-hes-sparse-s" title="Permalink to this headline"></a></h4>
<p>The <em>rev_hes_sparse</em> argument <em>s</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">CppAD::vector&lt;bool&gt;&amp;</span></code> <em>s</em></p>
</div></blockquote>
<p>and <em>s</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>m</em> .
This specifies a sparsity pattern for the matrix
<span class="math notranslate nohighlight">\(S(x) = g^{(1)} (y) \in \B{R}^{1 \times m}\)</span>.</p>
</section>
<section id="t">
<span id="atomic-one-rev-hes-sparse-t"></span><span id="index-47"></span><h4><a class="toc-backref" href="#id59">t</a><a class="headerlink" href="#t" title="Permalink to this headline"></a></h4>
<p>The <em>rev_hes_sparse</em> argument <em>t</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">CppAD::vector&lt;bool&gt;&amp;</span></code> <em>t</em></p>
</div></blockquote>
<p>and <em>t</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>n</em> .
The input values of its elements
are not specified (must not matter).
Upon return it represents a sparsity pattern for the matrix
<span class="math notranslate nohighlight">\(T(x) \in \B{R}^{1 \times n}\)</span> defined by</p>
<div class="math notranslate nohighlight">
\[T(x)  =  (g \circ f)^{(1)} (x) =  S(x) * f^{(1)} (x)\]</div>
</section>
<section id="u">
<span id="atomic-one-rev-hes-sparse-u"></span><span id="index-48"></span><h4><a class="toc-backref" href="#id60">u</a><a class="headerlink" href="#u" title="Permalink to this headline"></a></h4>
<p>The <em>rev_hes_sparse</em> argument <em>u</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">CppAD::vector&lt;</span> <span class="pre">std::set&lt;size_t&gt;</span> <span class="pre">&gt;&amp;</span></code> <em>u</em></p>
</div></blockquote>
<p>and <em>u</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>m</em> .
For <span class="math notranslate nohighlight">\(i = 0 , \ldots , m-1\)</span>,
all the elements of <em>u</em> [ <em>i</em> ]
are between zero and <em>q</em> <code class="docutils literal notranslate"><span class="pre">-1</span></code> inclusive.
This specifies a sparsity pattern
for the matrix <span class="math notranslate nohighlight">\(U(x) \in \B{R}^{m \times q}\)</span> defined by</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
U(x)
&amp; = &amp;
\partial_u \{ \partial_y g[ y + f^{(1)} (x) R u ] \}_{u=0}
\\
&amp; = &amp;
\partial_u \{ g^{(1)} [ y + f^{(1)} (x) R u ] \}_{u=0}
\\
&amp; = &amp;
g^{(2)} (y) f^{(1)} (x) R
\end{eqnarray}</div></section>
<section id="v">
<span id="atomic-one-rev-hes-sparse-v"></span><span id="index-49"></span><h4><a class="toc-backref" href="#id61">v</a><a class="headerlink" href="#v" title="Permalink to this headline"></a></h4>
<p>The <em>rev_hes_sparse</em> argument <em>v</em> has prototype</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">CppAD::vector&lt;</span> <span class="pre">std::set&lt;size_t&gt;</span> <span class="pre">&gt;&amp;</span></code> <em>v</em></p>
</div></blockquote>
<p>and <em>v</em> . <code class="docutils literal notranslate"><span class="pre">size</span></code> () &gt;= <em>n</em> .
The input values of its elements
are not specified (must not matter).
Upon return, for <span class="math notranslate nohighlight">\(j = 0, \ldots , n-1\)</span>,
all the elements of <em>v</em> [ <em>j</em> ]
are between zero and <em>q</em> <code class="docutils literal notranslate"><span class="pre">-1</span></code> inclusive.
This represents a sparsity pattern for the matrix
<span class="math notranslate nohighlight">\(V(x) \in \B{R}^{n \times q}\)</span> defined by</p>
<div class="math notranslate nohighlight">
\begin{eqnarray}
V(x)
&amp; = &amp;
\partial_u [ \partial_x (g \circ f) ( x + R u )  ]_{u=0}
\\
&amp; = &amp;
\partial_u [ (g \circ f)^{(1)}( x + R u )  ]_{u=0}
\\
&amp; = &amp;
(g \circ f)^{(2)}( x ) R
\\
&amp; = &amp;
f^{(1)} (x)^\R{T} g^{(2)} ( y ) f^{(1)} (x)  R
+
\sum_{i=1}^m [ g^{(1)} (y) ]_i \; f_i^{(2)} (x) R
\\
&amp; = &amp;
f^{(1)} (x)^\R{T} U(x)
+
\sum_{i=1}^m S(x)_i \; f_i^{(2)} (x) R
\end{eqnarray}</div></section>
</section>
<section id="clear">
<span id="atomic-one-clear"></span><span id="index-50"></span><h3><a class="toc-backref" href="#id62">clear</a><a class="headerlink" href="#clear" title="Permalink to this headline"></a></h3>
<p>User atomic functions hold onto static work space in order to
increase speed by avoiding system memory allocation calls.
The function call</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">user_atomic&lt;</span></code> <em>Base</em> &gt;:: <code class="docutils literal notranslate"><span class="pre">clear</span></code> ()</p>
</div></blockquote>
<p>makes to work space <a class="reference internal" href="ta_available.html#ta-available-name"><span class="std std-ref">available</span></a> to
for other uses by the same thread.
This should be called when you are done using the
atomic functions for a specific value of <em>Base</em> .</p>
<section id="restriction">
<span id="atomic-one-clear-restriction"></span><span id="index-51"></span><h4><a class="toc-backref" href="#id63">Restriction</a><a class="headerlink" href="#restriction" title="Permalink to this headline"></a></h4>
<p>The atomic function <code class="docutils literal notranslate"><span class="pre">clear</span></code> routine cannot be called
while in <a class="reference internal" href="ta_in_parallel.html#ta-in-parallel-name"><span class="std std-ref">parallel</span></a> execution mode.</p>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="cppad_ipopt_nlp.html" class="btn btn-neutral float-left" title="cppad_ipopt_nlp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="atomic_two.html" class="btn btn-neutral float-right" title="atomic_two" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright .</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>